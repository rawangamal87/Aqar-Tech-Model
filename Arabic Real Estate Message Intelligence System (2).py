{"cells":[{"cell_type":"markdown","metadata":{"id":"uKG1ryEo22iT"},"source":["# ***Welcome Real Estate project for Aqar Tech Company***\n","This notebook presents a real NLP-based solution to process real estate messages received via WhatsApp.  \n","The main objectives:\n","- Extract key information\n","- Filter sensitive content (phone numbers, prices)\n","- Prepare the data for a dashboard view\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Jdp8TnUc51Fi"},"source":["\n","## Special Thanks\n","Special thanks to **Aqar Tech** for providing the opportunity to work on this task.  \n","I'm excited to contribute and showcase my ability to deliver a clean, well-structured NLP pipeline.\n","\n"]},{"cell_type":"markdown","metadata":{"id":"XoRDTOol8n3G"},"source":["Prepared by: **Rawan Gamal |  AI & NLP Engineer**  \n","Date: July 2025\n","\n","*   Connect with me on LinkedIn:(https://linkedin.com/in/rawan-gamal-41aa0024b)\n"]},{"cell_type":"markdown","metadata":{"id":"qijtFkntMhwO"},"source":["# ***Tools & Libraries used***"]},{"cell_type":"code","execution_count":337,"metadata":{"id":"iYqmJ9A9Knva","executionInfo":{"status":"ok","timestamp":1754331106154,"user_tz":-180,"elapsed":17,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["import json\n","import pandas as pd\n","import numpy as np\n","import spacy\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import requests\n","from geopy.distance import geodesic\n","import ast\n","\n","\n","# For classification\n","from sklearn.model_selection import train_test_split\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.model_selection import train_test_split\n","import xgboost as xgb\n","from sklearn.metrics import classification_report, confusion_matrix\n","\n","import re\n","from tensorflow import keras\n","from tensorflow.keras.preprocessing.text import Tokenizer\n","from tensorflow.keras.preprocessing.sequence import pad_sequences\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Embedding, LSTM, Dense, Dropout, GRU\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.utils import resample\n","\n","# For deployment(Saving model)\n","import pickle\n","import joblib"]},{"cell_type":"markdown","metadata":{"id":"8JJlvDlhX0Wh"},"source":["# ***Load & Read Json File***"]},{"cell_type":"code","execution_count":338,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38161,"status":"ok","timestamp":1754331144314,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"iV-HzYPXRzhP","outputId":"7d229dd1-8866-4873-9600-25f083af7261"},"outputs":[{"output_type":"stream","name":"stdout","text":["Loaded page 1 with 100 messages.\n","Loaded page 2 with 100 messages.\n","Loaded page 3 with 100 messages.\n","Loaded page 4 with 100 messages.\n","Loaded page 5 with 100 messages.\n","Loaded page 6 with 100 messages.\n","Loaded page 7 with 100 messages.\n","Loaded page 8 with 100 messages.\n","Loaded page 9 with 100 messages.\n","Loaded page 10 with 100 messages.\n","\n","Total messages collected: 1000\n","                                       id    serial_number  \\\n","0    9f68fd95-515b-4c20-bf1b-9f1f2c7e5189  M-25-07-0048479   \n","1    9f68fd6e-d4d9-4b33-acc3-6c94c4c526d0  M-25-07-0048478   \n","2    9f68fd6c-9b19-4585-acb9-18dd29be4f11  M-25-07-0048477   \n","3    9f68fd0f-f3c9-4b76-ac25-a175256fd76b  M-25-07-0048476   \n","4    9f68fcae-adc9-48e1-8482-30915ac290bb  M-25-07-0048475   \n","..                                    ...              ...   \n","995  9f580ed0-3a05-4cc6-84c8-23c93bad806d  M-25-07-0046252   \n","996  9f580cc2-ff11-4071-80dd-6a1e9f5b9f98  M-25-07-0046251   \n","997  9f580c63-206d-4ec4-8777-ab40a538a572  M-25-07-0046250   \n","998  9f580c33-e867-4275-bc5c-4e0b11234f84  M-25-07-0046249   \n","999  9f580838-4b60-4a03-92e2-c1cea2de09ba  M-25-07-0046247   \n","\n","                                               message message_type  \\\n","0    للبيع ارض الهجرة ب  مساحة ٤٥٠م رقم  شارع ٢٥غرب...         none   \n","1                       قصدك تبغى العرض هذابنفس الآلية         none   \n","2    🔴فيلا للبيع كامله أو أدوار مستقله🔴  الرياض مخط...         none   \n","3    للبيع قطعة ارض في مخطط الهجره  ( ج )  رقم الار...         none   \n","4    السلام عليكم   مساء الخير    مطلوب عقارات مدرّ...         none   \n","..                                                 ...          ...   \n","995  الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...         none   \n","996  فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...        offer   \n","997  ⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...         none   \n","998  للببع مبنى عظم  في حي  السلامة ٢...<br />\\nظهي...         none   \n","999  🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...         none   \n","\n","    message_type_ar mediation_status      status state address  area  ...  \\\n","0              none             none         new  none    None  None  ...   \n","1              none             none         new  none    None  None  ...   \n","2              none             none         new  none    None  None  ...   \n","3              none             none         new  none    None  None  ...   \n","4              none             none         new  none    None  None  ...   \n","..              ...              ...         ...   ...     ...   ...  ...   \n","995            none             none    archived  none    None  None  ...   \n","996             عرض             none  realestate  sale    None  None  ...   \n","997            none             none    archived  none    None  None  ...   \n","998            none             none    archived  none    None  None  ...   \n","999            none             none    archived  none    None  None  ...   \n","\n","    price_type plan_number identical_message_count  \\\n","0         None        None                       0   \n","1         None        None                       0   \n","2         None        None                       0   \n","3         None        None                       0   \n","4         None        None                       0   \n","..         ...         ...                     ...   \n","995       None        None                       0   \n","996       None        None                       0   \n","997       None        None                       0   \n","998       None        None                       0   \n","999       None        None                       0   \n","\n","                                               contact  \\\n","0    {'id': '9f4b4502-39da-446e-a812-71219453c73e',...   \n","1    {'id': '9db44895-167b-47e1-806b-eb3dcdc6836b',...   \n","2    {'id': '9f5466a3-2ac1-44f1-87da-f46d9e6a394e',...   \n","3    {'id': '9eaac8d6-3e4a-475b-842a-8d7819049a28',...   \n","4    {'id': '9f68fcae-abac-4b25-ab46-881e0534ba76',...   \n","..                                                 ...   \n","995  {'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...   \n","996  {'id': '9f318a0d-8a46-445f-b069-009402839b68',...   \n","997  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","998  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","999  {'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...   \n","\n","                                                 group  \\\n","0    {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","1                                                 None   \n","2    {'id': '9e6cfe6a-90a9-469c-9bb7-9744c3cb8e03',...   \n","3    {'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...   \n","4    {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","..                                                 ...   \n","995  {'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...   \n","996  {'id': '9eb87e95-3217-477f-9144-2f283ade150d',...   \n","997  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","998  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","999  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","\n","                                                device  \\\n","0    {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","1    {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","2    {'id': '9db35b11-1ea4-4bc2-8800-bd51125965c4',...   \n","3    {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","4    {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","..                                                 ...   \n","995  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","996  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","997  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","998  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","999  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","\n","                                               country  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                region  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                  city  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                             districts  \n","0                                                   []  \n","1                                                   []  \n","2                                                   []  \n","3                                                   []  \n","4                                                   []  \n","..                                                 ...  \n","995                                                 []  \n","996  [{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...  \n","997                                                 []  \n","998                                                 []  \n","999                                                 []  \n","\n","[1000 rows x 21 columns]\n"]}],"source":["url = \"https://demo.aqar-tech.com/api/v1/messages\"\n","\n","all_messages = []   # The first 10 pages\n","\n","for page in range(1, 11):\n","    params = {\"page\": page}\n","    response = requests.get(url, params=params)\n","\n","    if response.status_code == 200:\n","        data = response.json()\n","        messages = data[\"result\"][\"data\"]\n","        all_messages.extend(messages)\n","        print(f\"Loaded page {page} with {len(messages)} messages.\")\n","    else:\n","        print(f\"Failed to load page {page}, status: {response.status_code}\")\n","\n","df = pd.DataFrame(all_messages)\n","print(f\"\\nTotal messages collected: {len(df)}\")\n","print(df)\n"]},{"cell_type":"code","execution_count":339,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"collapsed":true,"executionInfo":{"elapsed":124,"status":"ok","timestamp":1754331144440,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"KkIa5VzNolxO","outputId":"621f793b-5c6d-46a6-8215-ead350fa849d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id    serial_number  \\\n","975  9f58ac98-b7b7-4bd0-a53a-be366df76ab2  M-25-07-0046329   \n","976  9f58ac47-dcf4-4cad-bdd7-17b083b99a6b  M-25-07-0046328   \n","977  9f588ae2-229c-4637-a1c6-773e2e4173b7  M-25-07-0046318   \n","978  9f587f87-b722-4492-b7ed-d0d85d2e1486  M-25-07-0046314   \n","979  9f587ba3-53c1-41ee-bdaa-f12b7743a27f  M-25-07-0046310   \n","980  9f586b88-2343-4025-8081-264fe95cee37  M-25-07-0046303   \n","981  9f585cac-e018-421a-ac0c-efecda9328e8  M-25-07-0046283   \n","982  9f5859f6-af0f-4d21-aec3-ac979dd224d5  M-25-07-0046279   \n","983  9f58245b-1d5b-43f7-ba17-8243f86b3750  M-25-07-0046276   \n","984  9f582174-21c2-4684-adb1-1e0e7b678fff  M-25-07-0046275   \n","985  9f5820e4-517b-4936-b7a9-ed9de94ebe1d  M-25-07-0046273   \n","986  9f581fa1-6d38-4b49-a30f-a193dda54d55  M-25-07-0046272   \n","987  9f581f05-3398-403f-ac56-eaea0cb038bd  M-25-07-0046270   \n","988  9f581a08-2b2e-490d-b89c-74fb86900a8e  M-25-07-0046267   \n","989  9f581a07-3194-410a-a26e-a88abde9d74f  M-25-07-0046266   \n","990  9f5818a6-956d-46e9-8d07-911a0cfccd29  M-25-07-0046264   \n","991  9f58189a-b9eb-476d-92b3-7abdd1075e3c  M-25-07-0046263   \n","992  9f5814dc-9ad5-433f-bad7-1f83b18b473e  M-25-07-0046257   \n","993  9f581096-576e-4bf2-a24f-958eeee04c9b  M-25-07-0046254   \n","994  9f580faf-16cc-40d5-a89b-fdc06d52aebe  M-25-07-0046253   \n","995  9f580ed0-3a05-4cc6-84c8-23c93bad806d  M-25-07-0046252   \n","996  9f580cc2-ff11-4071-80dd-6a1e9f5b9f98  M-25-07-0046251   \n","997  9f580c63-206d-4ec4-8777-ab40a538a572  M-25-07-0046250   \n","998  9f580c33-e867-4275-bc5c-4e0b11234f84  M-25-07-0046249   \n","999  9f580838-4b60-4a03-92e2-c1cea2de09ba  M-25-07-0046247   \n","\n","                                               message message_type  \\\n","975  *للبيــــــــع فيلا بقيمه ارض راس بلوك على ثلا...        offer   \n","976  للبيع سبعة فلل  حي يرموك   خمسة فلل من دورين و...        offer   \n","977  فله دبلوكس بالدار البيضاء المساحه 220 الدور ال...        offer   \n","978  مخطط ٣١٢٩  مساحه ٩٠٠ م  اطوال ٣٠*٣٠ شارع ١٥ غر...        offer   \n","979  موجود فيلا  استثمارية في السويدي مساحة 506 طول...        offer   \n","980  فرصه عقاريه بدخل فوق ال 9%  للبيع عماره تجاريه...        offer   \n","981  ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...        offer   \n","982  للبيع ارض مخطط الرياض  جدة  جزء ها مساحة ٣١٢م ...         none   \n","983  للبيع راس بلك سكني   الحي ملقاء العساكر   المس...        offer   \n","984  مزرعه/ للإيجار ا في المغير في  مدينه العلا مسا...         none   \n","985  للبيــــــــع فيلا في حي اشبيليا المساحه٦٢٥ ال...        offer   \n","986  فله بحي الصحافه للبيع  مساحه ٣٩٠م عمرها  ١٢ سن...        offer   \n","987  🔴للبيع ارض تجارية في الفويلق بمحافظة بقعاء في ...         none   \n","988  ( للبيع بحي المعذر راس بلك سكني ) كقيمة أرض مو...        offer   \n","989  مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...        offer   \n","990  مطلوب من المالك  ارض في مخطط النخبة المساحة من...      request   \n","991  السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...      request   \n","992  للبيع      : فيلا عدد٤ الحي     : المروج  المس...        offer   \n","993  السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...      request   \n","994  *🍁🍁🍁 قروب نخبة العقاريين VIP 🍁🍁🍁* *🍁 رقم العرض...         none   \n","995  الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...         none   \n","996  فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...        offer   \n","997  ⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...         none   \n","998  للببع مبنى عظم  في حي  السلامة ٢...<br />\\nظهي...         none   \n","999  🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...         none   \n","\n","    message_type_ar mediation_status      status       state  \\\n","975             عرض             none  realestate        sale   \n","976             عرض             none  realestate        sale   \n","977             عرض             none  realestate        sale   \n","978             عرض             none  realestate        sale   \n","979             عرض             none  realestate  investment   \n","980             عرض             none  realestate        sale   \n","981             عرض             none  realestate        sale   \n","982            none             none    archived        none   \n","983             عرض             none  realestate        sale   \n","984            none             none    archived        none   \n","985             عرض             none  realestate        sale   \n","986             عرض             none  realestate        sale   \n","987            none             none    archived        none   \n","988             عرض             none  realestate        sale   \n","989             عرض             none  realestate        sale   \n","990             طلب             none  realestate        sale   \n","991             طلب             none  realestate        sale   \n","992             عرض             none  realestate        sale   \n","993             طلب             none  realestate        sale   \n","994            none             none    archived        none   \n","995            none             none    archived        none   \n","996             عرض             none  realestate        sale   \n","997            none             none    archived        none   \n","998            none             none    archived        none   \n","999            none             none    archived        none   \n","\n","                                               address        area  ...  \\\n","975          https://maps.app.goo.gl/BHtAfUFWfBThkEMF8     1560.00  ...   \n","976                                               None      220.00  ...   \n","977      https://goo.gl/maps/WyZLHEA1zRNXBYD6A?g_st=ac      220.00  ...   \n","978                                               None      900.00  ...   \n","979                                               None      506.00  ...   \n","980                                               None     1750.00  ...   \n","981  https://maps.app.goo.gl/ScsRTNj3CLTyWMfX7?g_st=iw  1000000.00  ...   \n","982                                               None        None  ...   \n","983  https://maps.app.goo.gl/MqwRA1CgrMzRubq18?g_st=aw     3600.00  ...   \n","984                                               None        None  ...   \n","985  https://maps.app.goo.gl/N5kjfUjn72Zte9w26?g_st...      625.00  ...   \n","986                                               None      390.00  ...   \n","987                                               None        None  ...   \n","988  https://maps.app.goo.gl/8SnmWT31VkwD3QMW8?g_st=iw    12162.00  ...   \n","989                                               None      918.00  ...   \n","990                                               None      500.00  ...   \n","991                                               None      700.00  ...   \n","992                                               None      250.00  ...   \n","993                                               None    10000.00  ...   \n","994                                               None        None  ...   \n","995                                               None        None  ...   \n","996                                               None        None  ...   \n","997                                               None        None  ...   \n","998                                               None        None  ...   \n","999                                               None        None  ...   \n","\n","    price_type plan_number identical_message_count  \\\n","975      Fixed        None                       0   \n","976      Fixed        None                       0   \n","977       None        None                       0   \n","978       None        3129                       0   \n","979      Fixed        None                       0   \n","980      Fixed        None                       0   \n","981      Fixed        None                       0   \n","982       None        None                       0   \n","983      Fixed        None                       0   \n","984       None        None                       0   \n","985      Fixed        None                       0   \n","986       None        None                       0   \n","987       None        None                       0   \n","988      Fixed        None                       0   \n","989    Auction        None                       0   \n","990       None        None                       0   \n","991      Fixed        None                       0   \n","992      Fixed        None                       0   \n","993       None        None                       0   \n","994       None        None                       0   \n","995       None        None                       0   \n","996       None        None                       0   \n","997       None        None                       0   \n","998       None        None                       0   \n","999       None        None                       0   \n","\n","                                               contact  \\\n","975  {'id': '9f0544a4-aeac-449c-8c81-1c9928e30c93',...   \n","976  {'id': '9f4d7bf2-2256-4049-9660-beca93138514',...   \n","977  {'id': '9f05f8d4-164e-4095-afab-a0410acfaacf',...   \n","978  {'id': '9f33641c-bc7c-4bf2-9141-7036cc5ce67f',...   \n","979  {'id': '9f4c08bc-fa7a-44d2-8677-f7758d0d2c20',...   \n","980  {'id': '9ddda6e0-0966-4554-9227-83922cca235f',...   \n","981  {'id': '9ea47eff-0822-4696-9506-e75bd001bf28',...   \n","982  {'id': '9f4b4502-39da-446e-a812-71219453c73e',...   \n","983  {'id': '9f3ef8ef-742a-4b8e-b453-f17931fdfe65',...   \n","984  {'id': '9f582174-202a-41d1-8539-291ee06f26d6',...   \n","985  {'id': '9f04a860-162e-4aeb-80e4-e2b2fbc1e8e1',...   \n","986  {'id': '9f581fa1-6bd7-4270-8a86-03a9cb292bc9',...   \n","987  {'id': '9eba8397-4d25-4c0e-9c2a-028b0f39638b',...   \n","988  {'id': '9f4590be-e15b-4deb-af87-77975cb270d0',...   \n","989  {'id': '9f4badcf-9194-49cd-8288-472c220b4d1f',...   \n","990  {'id': '9f5818a6-93ae-490a-adf4-b429dbb4d9bd',...   \n","991  {'id': '9f3ef8fc-e6d5-48ec-ac5e-2581dcd4a3dd',...   \n","992  {'id': '9dc04e62-634b-483f-9b0b-5ab7318794ac',...   \n","993  {'id': '9f581096-55ea-4a66-b3ce-8c1094791839',...   \n","994  {'id': '9f4c21b0-b510-4b44-971f-241648856c21',...   \n","995  {'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...   \n","996  {'id': '9f318a0d-8a46-445f-b069-009402839b68',...   \n","997  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","998  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","999  {'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...   \n","\n","                                                 group  \\\n","975  {'id': '9e6f13c4-ceff-4c5e-adaa-263115066c28',...   \n","976  {'id': '9db35acd-ffb5-42bb-a912-1cc987e17027',...   \n","977  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","978  {'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...   \n","979  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","980  {'id': '9e2994b0-9336-472b-bc04-f6d860f14a92',...   \n","981  {'id': '9f3f2543-64ae-4932-810d-f9a84e2975cd',...   \n","982  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","983  {'id': '9db35c27-33b3-435c-a13e-1faa8b0b6e55',...   \n","984  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","985  {'id': '9e6f13c4-ceff-4c5e-adaa-263115066c28',...   \n","986  {'id': '9eb87e95-3217-477f-9144-2f283ade150d',...   \n","987  {'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...   \n","988  {'id': '9db35c27-33b3-435c-a13e-1faa8b0b6e55',...   \n","989  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","990  {'id': '9db364e1-073e-43a0-8b12-86c1ca110328',...   \n","991  {'id': '9db35a85-ff66-4812-93ae-734e8ec79aa0',...   \n","992  {'id': '9db8f4e2-4d84-47d6-9a9c-97352456ad9a',...   \n","993  {'id': '9db35a85-ff66-4812-93ae-734e8ec79aa0',...   \n","994  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","995  {'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...   \n","996  {'id': '9eb87e95-3217-477f-9144-2f283ade150d',...   \n","997  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","998  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","999  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","\n","                                                device  \\\n","975  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","976  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","977  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","978  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","979  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","980  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","981  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","982  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","983  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","984  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","985  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","986  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","987  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","988  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","989  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","990  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","991  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","992  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","993  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","994  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","995  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","996  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","997  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","998  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","999  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","\n","                                               country  \\\n","975  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","976  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","977  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","978  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","979  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","980  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","981  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","982                                               None   \n","983  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","984                                               None   \n","985  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","986  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","987                                               None   \n","988  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","989  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","990  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","991  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","992  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","993  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","994                                               None   \n","995                                               None   \n","996  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                region  \\\n","975  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","976  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","977  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","978  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","979  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","980  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","981  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","982                                               None   \n","983  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","984                                               None   \n","985  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","986  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","987                                               None   \n","988  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","989  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","990  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","991  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","992  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","993  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","994                                               None   \n","995                                               None   \n","996  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                  city  \\\n","975  {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...   \n","976  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","977  {'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...   \n","978  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","979  {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...   \n","980  {'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...   \n","981  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","982                                               None   \n","983  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...   \n","984                                               None   \n","985  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","986  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...   \n","987                                               None   \n","988  {'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...   \n","989  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...   \n","990  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","991  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","992  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...   \n","993  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...   \n","994                                               None   \n","995                                               None   \n","996  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                             districts  \n","975  [{'id': '9f5b8d80-49e9-4745-8feb-55d3086a71ec'...  \n","976  [{'id': '9f5b8dff-44e1-4f12-8022-c921e1b055cc'...  \n","977  [{'id': '9f5b8e7c-d3bf-4f69-802b-990dfe9fe649'...  \n","978  [{'id': '9f5b8f30-1aa0-4c71-b0b7-5f533a6267dc'...  \n","979  [{'id': '9f5b8fae-e485-45fd-8a44-878961359407'...  \n","980  [{'id': '9f5b904b-e30e-4232-873c-a3ac95445201'...  \n","981  [{'id': '9f59652d-acd0-46a4-a483-7a9cff9cf56a'...  \n","982                                                 []  \n","983  [{'id': '9f5965b3-338e-421b-b586-8ebb10f57608'...  \n","984                                                 []  \n","985  [{'id': '9f5965fc-aefd-484d-989e-7777baac7b02'...  \n","986  [{'id': '9f5967a4-2c40-441e-aa60-ebc27ee0c744'...  \n","987                                                 []  \n","988  [{'id': '9f59a136-7ccf-4164-be1a-73c88280b7f2'...  \n","989  [{'id': '9f59680d-5094-44e6-8953-5475fbafb565'...  \n","990  [{'id': '9f599fd4-e34f-41fe-a97b-f3a2a5a8ba44'...  \n","991  [{'id': '9f59a209-694c-4c4b-aec1-cee4378d980a'...  \n","992  [{'id': '9f59a45b-2204-4521-be4d-4a6136f2182f'...  \n","993  [{'id': '9f59a4bd-ccee-4aef-86c8-46a74949d0ec'...  \n","994                                                 []  \n","995                                                 []  \n","996  [{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...  \n","997                                                 []  \n","998                                                 []  \n","999                                                 []  \n","\n","[25 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-797a8a90-919e-472d-9d8b-c67a6f3a5b1a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>serial_number</th>\n","      <th>message</th>\n","      <th>message_type</th>\n","      <th>message_type_ar</th>\n","      <th>mediation_status</th>\n","      <th>status</th>\n","      <th>state</th>\n","      <th>address</th>\n","      <th>area</th>\n","      <th>...</th>\n","      <th>price_type</th>\n","      <th>plan_number</th>\n","      <th>identical_message_count</th>\n","      <th>contact</th>\n","      <th>group</th>\n","      <th>device</th>\n","      <th>country</th>\n","      <th>region</th>\n","      <th>city</th>\n","      <th>districts</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>975</th>\n","      <td>9f58ac98-b7b7-4bd0-a53a-be366df76ab2</td>\n","      <td>M-25-07-0046329</td>\n","      <td>*للبيــــــــع فيلا بقيمه ارض راس بلوك على ثلا...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>https://maps.app.goo.gl/BHtAfUFWfBThkEMF8</td>\n","      <td>1560.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f0544a4-aeac-449c-8c81-1c9928e30c93',...</td>\n","      <td>{'id': '9e6f13c4-ceff-4c5e-adaa-263115066c28',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...</td>\n","      <td>[{'id': '9f5b8d80-49e9-4745-8feb-55d3086a71ec'...</td>\n","    </tr>\n","    <tr>\n","      <th>976</th>\n","      <td>9f58ac47-dcf4-4cad-bdd7-17b083b99a6b</td>\n","      <td>M-25-07-0046328</td>\n","      <td>للبيع سبعة فلل  حي يرموك   خمسة فلل من دورين و...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>220.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4d7bf2-2256-4049-9660-beca93138514',...</td>\n","      <td>{'id': '9db35acd-ffb5-42bb-a912-1cc987e17027',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f5b8dff-44e1-4f12-8022-c921e1b055cc'...</td>\n","    </tr>\n","    <tr>\n","      <th>977</th>\n","      <td>9f588ae2-229c-4637-a1c6-773e2e4173b7</td>\n","      <td>M-25-07-0046318</td>\n","      <td>فله دبلوكس بالدار البيضاء المساحه 220 الدور ال...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>https://goo.gl/maps/WyZLHEA1zRNXBYD6A?g_st=ac</td>\n","      <td>220.00</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f05f8d4-164e-4095-afab-a0410acfaacf',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...</td>\n","      <td>[{'id': '9f5b8e7c-d3bf-4f69-802b-990dfe9fe649'...</td>\n","    </tr>\n","    <tr>\n","      <th>978</th>\n","      <td>9f587f87-b722-4492-b7ed-d0d85d2e1486</td>\n","      <td>M-25-07-0046314</td>\n","      <td>مخطط ٣١٢٩  مساحه ٩٠٠ م  اطوال ٣٠*٣٠ شارع ١٥ غر...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>900.00</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>3129</td>\n","      <td>0</td>\n","      <td>{'id': '9f33641c-bc7c-4bf2-9141-7036cc5ce67f',...</td>\n","      <td>{'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f5b8f30-1aa0-4c71-b0b7-5f533a6267dc'...</td>\n","    </tr>\n","    <tr>\n","      <th>979</th>\n","      <td>9f587ba3-53c1-41ee-bdaa-f12b7743a27f</td>\n","      <td>M-25-07-0046310</td>\n","      <td>موجود فيلا  استثمارية في السويدي مساحة 506 طول...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>investment</td>\n","      <td>None</td>\n","      <td>506.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4c08bc-fa7a-44d2-8677-f7758d0d2c20',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...</td>\n","      <td>[{'id': '9f5b8fae-e485-45fd-8a44-878961359407'...</td>\n","    </tr>\n","    <tr>\n","      <th>980</th>\n","      <td>9f586b88-2343-4025-8081-264fe95cee37</td>\n","      <td>M-25-07-0046303</td>\n","      <td>فرصه عقاريه بدخل فوق ال 9%  للبيع عماره تجاريه...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>1750.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9ddda6e0-0966-4554-9227-83922cca235f',...</td>\n","      <td>{'id': '9e2994b0-9336-472b-bc04-f6d860f14a92',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...</td>\n","      <td>[{'id': '9f5b904b-e30e-4232-873c-a3ac95445201'...</td>\n","    </tr>\n","    <tr>\n","      <th>981</th>\n","      <td>9f585cac-e018-421a-ac0c-efecda9328e8</td>\n","      <td>M-25-07-0046283</td>\n","      <td>ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>https://maps.app.goo.gl/ScsRTNj3CLTyWMfX7?g_st=iw</td>\n","      <td>1000000.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9ea47eff-0822-4696-9506-e75bd001bf28',...</td>\n","      <td>{'id': '9f3f2543-64ae-4932-810d-f9a84e2975cd',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f59652d-acd0-46a4-a483-7a9cff9cf56a'...</td>\n","    </tr>\n","    <tr>\n","      <th>982</th>\n","      <td>9f5859f6-af0f-4d21-aec3-ac979dd224d5</td>\n","      <td>M-25-07-0046279</td>\n","      <td>للبيع ارض مخطط الرياض  جدة  جزء ها مساحة ٣١٢م ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4b4502-39da-446e-a812-71219453c73e',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>983</th>\n","      <td>9f58245b-1d5b-43f7-ba17-8243f86b3750</td>\n","      <td>M-25-07-0046276</td>\n","      <td>للبيع راس بلك سكني   الحي ملقاء العساكر   المس...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>https://maps.app.goo.gl/MqwRA1CgrMzRubq18?g_st=aw</td>\n","      <td>3600.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f3ef8ef-742a-4b8e-b453-f17931fdfe65',...</td>\n","      <td>{'id': '9db35c27-33b3-435c-a13e-1faa8b0b6e55',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>[{'id': '9f5965b3-338e-421b-b586-8ebb10f57608'...</td>\n","    </tr>\n","    <tr>\n","      <th>984</th>\n","      <td>9f582174-21c2-4684-adb1-1e0e7b678fff</td>\n","      <td>M-25-07-0046275</td>\n","      <td>مزرعه/ للإيجار ا في المغير في  مدينه العلا مسا...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f582174-202a-41d1-8539-291ee06f26d6',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>985</th>\n","      <td>9f5820e4-517b-4936-b7a9-ed9de94ebe1d</td>\n","      <td>M-25-07-0046273</td>\n","      <td>للبيــــــــع فيلا في حي اشبيليا المساحه٦٢٥ ال...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>https://maps.app.goo.gl/N5kjfUjn72Zte9w26?g_st...</td>\n","      <td>625.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f04a860-162e-4aeb-80e4-e2b2fbc1e8e1',...</td>\n","      <td>{'id': '9e6f13c4-ceff-4c5e-adaa-263115066c28',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f5965fc-aefd-484d-989e-7777baac7b02'...</td>\n","    </tr>\n","    <tr>\n","      <th>986</th>\n","      <td>9f581fa1-6d38-4b49-a30f-a193dda54d55</td>\n","      <td>M-25-07-0046272</td>\n","      <td>فله بحي الصحافه للبيع  مساحه ٣٩٠م عمرها  ١٢ سن...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>390.00</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f581fa1-6bd7-4270-8a86-03a9cb292bc9',...</td>\n","      <td>{'id': '9eb87e95-3217-477f-9144-2f283ade150d',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>[{'id': '9f5967a4-2c40-441e-aa60-ebc27ee0c744'...</td>\n","    </tr>\n","    <tr>\n","      <th>987</th>\n","      <td>9f581f05-3398-403f-ac56-eaea0cb038bd</td>\n","      <td>M-25-07-0046270</td>\n","      <td>🔴للبيع ارض تجارية في الفويلق بمحافظة بقعاء في ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9eba8397-4d25-4c0e-9c2a-028b0f39638b',...</td>\n","      <td>{'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>988</th>\n","      <td>9f581a08-2b2e-490d-b89c-74fb86900a8e</td>\n","      <td>M-25-07-0046267</td>\n","      <td>( للبيع بحي المعذر راس بلك سكني ) كقيمة أرض مو...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>https://maps.app.goo.gl/8SnmWT31VkwD3QMW8?g_st=iw</td>\n","      <td>12162.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4590be-e15b-4deb-af87-77975cb270d0',...</td>\n","      <td>{'id': '9db35c27-33b3-435c-a13e-1faa8b0b6e55',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...</td>\n","      <td>[{'id': '9f59a136-7ccf-4164-be1a-73c88280b7f2'...</td>\n","    </tr>\n","    <tr>\n","      <th>989</th>\n","      <td>9f581a07-3194-410a-a26e-a88abde9d74f</td>\n","      <td>M-25-07-0046266</td>\n","      <td>مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>918.00</td>\n","      <td>...</td>\n","      <td>Auction</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4badcf-9194-49cd-8288-472c220b4d1f',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>[{'id': '9f59680d-5094-44e6-8953-5475fbafb565'...</td>\n","    </tr>\n","    <tr>\n","      <th>990</th>\n","      <td>9f5818a6-956d-46e9-8d07-911a0cfccd29</td>\n","      <td>M-25-07-0046264</td>\n","      <td>مطلوب من المالك  ارض في مخطط النخبة المساحة من...</td>\n","      <td>request</td>\n","      <td>طلب</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>500.00</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f5818a6-93ae-490a-adf4-b429dbb4d9bd',...</td>\n","      <td>{'id': '9db364e1-073e-43a0-8b12-86c1ca110328',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f599fd4-e34f-41fe-a97b-f3a2a5a8ba44'...</td>\n","    </tr>\n","    <tr>\n","      <th>991</th>\n","      <td>9f58189a-b9eb-476d-92b3-7abdd1075e3c</td>\n","      <td>M-25-07-0046263</td>\n","      <td>السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...</td>\n","      <td>request</td>\n","      <td>طلب</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>700.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f3ef8fc-e6d5-48ec-ac5e-2581dcd4a3dd',...</td>\n","      <td>{'id': '9db35a85-ff66-4812-93ae-734e8ec79aa0',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f59a209-694c-4c4b-aec1-cee4378d980a'...</td>\n","    </tr>\n","    <tr>\n","      <th>992</th>\n","      <td>9f5814dc-9ad5-433f-bad7-1f83b18b473e</td>\n","      <td>M-25-07-0046257</td>\n","      <td>للبيع      : فيلا عدد٤ الحي     : المروج  المس...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>250.00</td>\n","      <td>...</td>\n","      <td>Fixed</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9dc04e62-634b-483f-9b0b-5ab7318794ac',...</td>\n","      <td>{'id': '9db8f4e2-4d84-47d6-9a9c-97352456ad9a',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>[{'id': '9f59a45b-2204-4521-be4d-4a6136f2182f'...</td>\n","    </tr>\n","    <tr>\n","      <th>993</th>\n","      <td>9f581096-576e-4bf2-a24f-958eeee04c9b</td>\n","      <td>M-25-07-0046254</td>\n","      <td>السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...</td>\n","      <td>request</td>\n","      <td>طلب</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>10000.00</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f581096-55ea-4a66-b3ce-8c1094791839',...</td>\n","      <td>{'id': '9db35a85-ff66-4812-93ae-734e8ec79aa0',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>[{'id': '9f59a4bd-ccee-4aef-86c8-46a74949d0ec'...</td>\n","    </tr>\n","    <tr>\n","      <th>994</th>\n","      <td>9f580faf-16cc-40d5-a89b-fdc06d52aebe</td>\n","      <td>M-25-07-0046253</td>\n","      <td>*🍁🍁🍁 قروب نخبة العقاريين VIP 🍁🍁🍁* *🍁 رقم العرض...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4c21b0-b510-4b44-971f-241648856c21',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>995</th>\n","      <td>9f580ed0-3a05-4cc6-84c8-23c93bad806d</td>\n","      <td>M-25-07-0046252</td>\n","      <td>الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...</td>\n","      <td>{'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>996</th>\n","      <td>9f580cc2-ff11-4071-80dd-6a1e9f5b9f98</td>\n","      <td>M-25-07-0046251</td>\n","      <td>فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f318a0d-8a46-445f-b069-009402839b68',...</td>\n","      <td>{'id': '9eb87e95-3217-477f-9144-2f283ade150d',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...</td>\n","    </tr>\n","    <tr>\n","      <th>997</th>\n","      <td>9f580c63-206d-4ec4-8777-ab40a538a572</td>\n","      <td>M-25-07-0046250</td>\n","      <td>⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>998</th>\n","      <td>9f580c33-e867-4275-bc5c-4e0b11234f84</td>\n","      <td>M-25-07-0046249</td>\n","      <td>للببع مبنى عظم  في حي  السلامة ٢...&lt;br /&gt;\\nظهي...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>999</th>\n","      <td>9f580838-4b60-4a03-92e2-c1cea2de09ba</td>\n","      <td>M-25-07-0046247</td>\n","      <td>🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>25 rows × 21 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-797a8a90-919e-472d-9d8b-c67a6f3a5b1a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-797a8a90-919e-472d-9d8b-c67a6f3a5b1a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-797a8a90-919e-472d-9d8b-c67a6f3a5b1a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-59b71579-5f71-41fc-ac6b-7e73c25fd1d1\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-59b71579-5f71-41fc-ac6b-7e73c25fd1d1')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-59b71579-5f71-41fc-ac6b-7e73c25fd1d1 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{},"execution_count":339}],"source":["df.tail(25)"]},{"cell_type":"code","execution_count":340,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1754331144454,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"IW-rhvySMGzh","outputId":"356a6700-a7c7-4ada-f5ad-8b144aa13fe3"},"outputs":[{"output_type":"stream","name":"stdout","text":["Total messages collected: 1000\n"]}],"source":["# num of rows\n","print(f\"Total messages collected: {len(df)}\")"]},{"cell_type":"code","execution_count":341,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":6,"status":"ok","timestamp":1754331144462,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"5LyTGuINDfdO","outputId":"2629b934-d03c-4104-8afc-c5903e068aa2"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1000 entries, 0 to 999\n","Data columns (total 21 columns):\n"," #   Column                   Non-Null Count  Dtype \n","---  ------                   --------------  ----- \n"," 0   id                       1000 non-null   object\n"," 1   serial_number            1000 non-null   object\n"," 2   message                  1000 non-null   object\n"," 3   message_type             1000 non-null   object\n"," 4   message_type_ar          1000 non-null   object\n"," 5   mediation_status         1000 non-null   object\n"," 6   status                   1000 non-null   object\n"," 7   state                    1000 non-null   object\n"," 8   address                  177 non-null    object\n"," 9   area                     491 non-null    object\n"," 10  price                    421 non-null    object\n"," 11  price_type               422 non-null    object\n"," 12  plan_number              96 non-null     object\n"," 13  identical_message_count  1000 non-null   int64 \n"," 14  contact                  1000 non-null   object\n"," 15  group                    996 non-null    object\n"," 16  device                   998 non-null    object\n"," 17  country                  498 non-null    object\n"," 18  region                   498 non-null    object\n"," 19  city                     496 non-null    object\n"," 20  districts                1000 non-null   object\n","dtypes: int64(1), object(20)\n","memory usage: 164.2+ KB\n"]}],"source":["df.info()"]},{"cell_type":"code","execution_count":342,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":20,"status":"ok","timestamp":1754331144483,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"9jazrdPcDhgF","outputId":"18cbd2d3-4039-4dd3-c781-673a7690b80b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['id', 'serial_number', 'message', 'message_type', 'message_type_ar',\n","       'mediation_status', 'status', 'state', 'address', 'area', 'price',\n","       'price_type', 'plan_number', 'identical_message_count', 'contact',\n","       'group', 'device', 'country', 'region', 'city', 'districts'],\n","      dtype='object')"]},"metadata":{},"execution_count":342}],"source":["df.columns"]},{"cell_type":"code","execution_count":343,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1754331144493,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"_iMh5eh1Dyni","outputId":"826832a6-bafb-47b4-9e5c-23be7b1910df"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["21"]},"metadata":{},"execution_count":343}],"source":["len(df.columns)"]},{"cell_type":"markdown","metadata":{"id":"uSBHnsAJYELC"},"source":["# ***Text processing***"]},{"cell_type":"code","execution_count":344,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":64,"status":"ok","timestamp":1754331144560,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"MykzNU9BKvYC","outputId":"0172231b-6747-4348-e759-3e464676939a"},"outputs":[{"output_type":"stream","name":"stdout","text":["مطلوب موقع مغسلة سيارات للإجار الدمام\n"]}],"source":["print(df['message'].iloc[255])"]},{"cell_type":"code","execution_count":345,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":257},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1754331144575,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"IaAbBscjKvWW","outputId":"af187904-9140-484f-b467-2e32662006af"},"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-3382297131.py:1: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.\n","The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.\n","\n","For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.\n","\n","\n","  df['message'].fillna('', inplace=True)\n"]},{"output_type":"display_data","data":{"text/plain":["message    0\n","dtype: int64"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>message</th>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div><br><label><b>dtype:</b> int64</label>"]},"metadata":{}}],"source":["df['message'].fillna('', inplace=True)\n","display(df[['message']].isnull().sum())      #num of nan"]},{"cell_type":"code","execution_count":346,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"collapsed":true,"executionInfo":{"elapsed":44,"status":"ok","timestamp":1754331144617,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"HoX_ZD4AKvUc","outputId":"f5443e97-c066-4143-f297-0497f89b63bb"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id    serial_number  \\\n","0    9f68fd95-515b-4c20-bf1b-9f1f2c7e5189  M-25-07-0048479   \n","1    9f68fd6e-d4d9-4b33-acc3-6c94c4c526d0  M-25-07-0048478   \n","2    9f68fd6c-9b19-4585-acb9-18dd29be4f11  M-25-07-0048477   \n","3    9f68fd0f-f3c9-4b76-ac25-a175256fd76b  M-25-07-0048476   \n","4    9f68fcae-adc9-48e1-8482-30915ac290bb  M-25-07-0048475   \n","..                                    ...              ...   \n","995  9f580ed0-3a05-4cc6-84c8-23c93bad806d  M-25-07-0046252   \n","996  9f580cc2-ff11-4071-80dd-6a1e9f5b9f98  M-25-07-0046251   \n","997  9f580c63-206d-4ec4-8777-ab40a538a572  M-25-07-0046250   \n","998  9f580c33-e867-4275-bc5c-4e0b11234f84  M-25-07-0046249   \n","999  9f580838-4b60-4a03-92e2-c1cea2de09ba  M-25-07-0046247   \n","\n","                                               message message_type label  \\\n","0    للبيع ارض الهجرة ب  مساحة ٤٥٠م رقم  شارع ٢٥غرب...         none  none   \n","1                       قصدك تبغى العرض هذابنفس الآلية         none  none   \n","2    🔴فيلا للبيع كامله أو أدوار مستقله🔴  الرياض مخط...         none  none   \n","3    للبيع قطعة ارض في مخطط الهجره  ( ج )  رقم الار...         none  none   \n","4    السلام عليكم   مساء الخير    مطلوب عقارات مدرّ...         none  none   \n","..                                                 ...          ...   ...   \n","995  الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...         none  none   \n","996  فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...        offer   عرض   \n","997  ⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...         none  none   \n","998  للببع مبنى عظم  في حي  السلامة ٢...<br />\\nظهي...         none  none   \n","999  🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...         none  none   \n","\n","    mediation_status      status state address  area  ... price_type  \\\n","0               none         new  none    None  None  ...       None   \n","1               none         new  none    None  None  ...       None   \n","2               none         new  none    None  None  ...       None   \n","3               none         new  none    None  None  ...       None   \n","4               none         new  none    None  None  ...       None   \n","..               ...         ...   ...     ...   ...  ...        ...   \n","995             none    archived  none    None  None  ...       None   \n","996             none  realestate  sale    None  None  ...       None   \n","997             none    archived  none    None  None  ...       None   \n","998             none    archived  none    None  None  ...       None   \n","999             none    archived  none    None  None  ...       None   \n","\n","    plan_number identical_message_count  \\\n","0          None                       0   \n","1          None                       0   \n","2          None                       0   \n","3          None                       0   \n","4          None                       0   \n","..          ...                     ...   \n","995        None                       0   \n","996        None                       0   \n","997        None                       0   \n","998        None                       0   \n","999        None                       0   \n","\n","                                               contact  \\\n","0    {'id': '9f4b4502-39da-446e-a812-71219453c73e',...   \n","1    {'id': '9db44895-167b-47e1-806b-eb3dcdc6836b',...   \n","2    {'id': '9f5466a3-2ac1-44f1-87da-f46d9e6a394e',...   \n","3    {'id': '9eaac8d6-3e4a-475b-842a-8d7819049a28',...   \n","4    {'id': '9f68fcae-abac-4b25-ab46-881e0534ba76',...   \n","..                                                 ...   \n","995  {'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...   \n","996  {'id': '9f318a0d-8a46-445f-b069-009402839b68',...   \n","997  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","998  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","999  {'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...   \n","\n","                                                 group  \\\n","0    {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","1                                                 None   \n","2    {'id': '9e6cfe6a-90a9-469c-9bb7-9744c3cb8e03',...   \n","3    {'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...   \n","4    {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","..                                                 ...   \n","995  {'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...   \n","996  {'id': '9eb87e95-3217-477f-9144-2f283ade150d',...   \n","997  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","998  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","999  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","\n","                                                device  \\\n","0    {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","1    {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","2    {'id': '9db35b11-1ea4-4bc2-8800-bd51125965c4',...   \n","3    {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","4    {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","..                                                 ...   \n","995  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","996  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","997  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","998  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","999  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","\n","                                               country  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                region  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                  city  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                             districts  \n","0                                                   []  \n","1                                                   []  \n","2                                                   []  \n","3                                                   []  \n","4                                                   []  \n","..                                                 ...  \n","995                                                 []  \n","996  [{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...  \n","997                                                 []  \n","998                                                 []  \n","999                                                 []  \n","\n","[1000 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-ea41c6fb-101c-46f3-b0b9-ed5430b5b024\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>serial_number</th>\n","      <th>message</th>\n","      <th>message_type</th>\n","      <th>label</th>\n","      <th>mediation_status</th>\n","      <th>status</th>\n","      <th>state</th>\n","      <th>address</th>\n","      <th>area</th>\n","      <th>...</th>\n","      <th>price_type</th>\n","      <th>plan_number</th>\n","      <th>identical_message_count</th>\n","      <th>contact</th>\n","      <th>group</th>\n","      <th>device</th>\n","      <th>country</th>\n","      <th>region</th>\n","      <th>city</th>\n","      <th>districts</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>9f68fd95-515b-4c20-bf1b-9f1f2c7e5189</td>\n","      <td>M-25-07-0048479</td>\n","      <td>للبيع ارض الهجرة ب  مساحة ٤٥٠م رقم  شارع ٢٥غرب...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4b4502-39da-446e-a812-71219453c73e',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>9f68fd6e-d4d9-4b33-acc3-6c94c4c526d0</td>\n","      <td>M-25-07-0048478</td>\n","      <td>قصدك تبغى العرض هذابنفس الآلية</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9db44895-167b-47e1-806b-eb3dcdc6836b',...</td>\n","      <td>None</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>9f68fd6c-9b19-4585-acb9-18dd29be4f11</td>\n","      <td>M-25-07-0048477</td>\n","      <td>🔴فيلا للبيع كامله أو أدوار مستقله🔴  الرياض مخط...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f5466a3-2ac1-44f1-87da-f46d9e6a394e',...</td>\n","      <td>{'id': '9e6cfe6a-90a9-469c-9bb7-9744c3cb8e03',...</td>\n","      <td>{'id': '9db35b11-1ea4-4bc2-8800-bd51125965c4',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>9f68fd0f-f3c9-4b76-ac25-a175256fd76b</td>\n","      <td>M-25-07-0048476</td>\n","      <td>للبيع قطعة ارض في مخطط الهجره  ( ج )  رقم الار...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9eaac8d6-3e4a-475b-842a-8d7819049a28',...</td>\n","      <td>{'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>9f68fcae-adc9-48e1-8482-30915ac290bb</td>\n","      <td>M-25-07-0048475</td>\n","      <td>السلام عليكم   مساء الخير    مطلوب عقارات مدرّ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f68fcae-abac-4b25-ab46-881e0534ba76',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>995</th>\n","      <td>9f580ed0-3a05-4cc6-84c8-23c93bad806d</td>\n","      <td>M-25-07-0046252</td>\n","      <td>الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...</td>\n","      <td>{'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>996</th>\n","      <td>9f580cc2-ff11-4071-80dd-6a1e9f5b9f98</td>\n","      <td>M-25-07-0046251</td>\n","      <td>فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f318a0d-8a46-445f-b069-009402839b68',...</td>\n","      <td>{'id': '9eb87e95-3217-477f-9144-2f283ade150d',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...</td>\n","    </tr>\n","    <tr>\n","      <th>997</th>\n","      <td>9f580c63-206d-4ec4-8777-ab40a538a572</td>\n","      <td>M-25-07-0046250</td>\n","      <td>⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>998</th>\n","      <td>9f580c33-e867-4275-bc5c-4e0b11234f84</td>\n","      <td>M-25-07-0046249</td>\n","      <td>للببع مبنى عظم  في حي  السلامة ٢...&lt;br /&gt;\\nظهي...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>999</th>\n","      <td>9f580838-4b60-4a03-92e2-c1cea2de09ba</td>\n","      <td>M-25-07-0046247</td>\n","      <td>🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1000 rows × 21 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ea41c6fb-101c-46f3-b0b9-ed5430b5b024')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-ea41c6fb-101c-46f3-b0b9-ed5430b5b024 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-ea41c6fb-101c-46f3-b0b9-ed5430b5b024');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-c652e737-4e7c-404c-b4ad-c59b31b8a4b0\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-c652e737-4e7c-404c-b4ad-c59b31b8a4b0')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-c652e737-4e7c-404c-b4ad-c59b31b8a4b0 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_ec255885-30a8-48ca-b426-6aeef3b1e094\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_ec255885-30a8-48ca-b426-6aeef3b1e094 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df"}},"metadata":{},"execution_count":346}],"source":["# message_type_ar\t>>> label\n","df.rename(columns={'message_type_ar': 'label'}, inplace=True)\n","df"]},{"cell_type":"code","execution_count":347,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"collapsed":true,"executionInfo":{"elapsed":7,"status":"ok","timestamp":1754331144644,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"Y3f5VF7iYXkZ","outputId":"c35cad98-b758-48a6-922c-ca8a6fae9241"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id    serial_number  \\\n","0    9f68fd95-515b-4c20-bf1b-9f1f2c7e5189  M-25-07-0048479   \n","1    9f68fd6e-d4d9-4b33-acc3-6c94c4c526d0  M-25-07-0048478   \n","2    9f68fd6c-9b19-4585-acb9-18dd29be4f11  M-25-07-0048477   \n","3    9f68fd0f-f3c9-4b76-ac25-a175256fd76b  M-25-07-0048476   \n","4    9f68fcae-adc9-48e1-8482-30915ac290bb  M-25-07-0048475   \n","..                                    ...              ...   \n","995  9f580ed0-3a05-4cc6-84c8-23c93bad806d  M-25-07-0046252   \n","996  9f580cc2-ff11-4071-80dd-6a1e9f5b9f98  M-25-07-0046251   \n","997  9f580c63-206d-4ec4-8777-ab40a538a572  M-25-07-0046250   \n","998  9f580c33-e867-4275-bc5c-4e0b11234f84  M-25-07-0046249   \n","999  9f580838-4b60-4a03-92e2-c1cea2de09ba  M-25-07-0046247   \n","\n","                                               message message_type label  \\\n","0    للبيع ارض الهجرة ب  مساحة ٤٥٠م رقم  شارع ٢٥غرب...         none  none   \n","1                       قصدك تبغى العرض هذابنفس الآلية         none  none   \n","2    🔴فيلا للبيع كامله أو أدوار مستقله🔴  الرياض مخط...         none  none   \n","3    للبيع قطعة ارض في مخطط الهجره  ( ج )  رقم الار...         none  none   \n","4    السلام عليكم   مساء الخير    مطلوب عقارات مدرّ...         none  none   \n","..                                                 ...          ...   ...   \n","995  الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...         none  none   \n","996  فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...        offer   عرض   \n","997  ⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...         none  none   \n","998  للببع مبنى عظم  في حي  السلامة ٢...<br />\\nظهي...         none  none   \n","999  🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...         none  none   \n","\n","    mediation_status      status state address  area  ... price_type  \\\n","0               none         new  none    None  None  ...       None   \n","1               none         new  none    None  None  ...       None   \n","2               none         new  none    None  None  ...       None   \n","3               none         new  none    None  None  ...       None   \n","4               none         new  none    None  None  ...       None   \n","..               ...         ...   ...     ...   ...  ...        ...   \n","995             none    archived  none    None  None  ...       None   \n","996             none  realestate  sale    None  None  ...       None   \n","997             none    archived  none    None  None  ...       None   \n","998             none    archived  none    None  None  ...       None   \n","999             none    archived  none    None  None  ...       None   \n","\n","    plan_number identical_message_count  \\\n","0          None                       0   \n","1          None                       0   \n","2          None                       0   \n","3          None                       0   \n","4          None                       0   \n","..          ...                     ...   \n","995        None                       0   \n","996        None                       0   \n","997        None                       0   \n","998        None                       0   \n","999        None                       0   \n","\n","                                               contact  \\\n","0    {'id': '9f4b4502-39da-446e-a812-71219453c73e',...   \n","1    {'id': '9db44895-167b-47e1-806b-eb3dcdc6836b',...   \n","2    {'id': '9f5466a3-2ac1-44f1-87da-f46d9e6a394e',...   \n","3    {'id': '9eaac8d6-3e4a-475b-842a-8d7819049a28',...   \n","4    {'id': '9f68fcae-abac-4b25-ab46-881e0534ba76',...   \n","..                                                 ...   \n","995  {'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...   \n","996  {'id': '9f318a0d-8a46-445f-b069-009402839b68',...   \n","997  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","998  {'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...   \n","999  {'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...   \n","\n","                                                 group  \\\n","0    {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","1                                                 None   \n","2    {'id': '9e6cfe6a-90a9-469c-9bb7-9744c3cb8e03',...   \n","3    {'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...   \n","4    {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","..                                                 ...   \n","995  {'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...   \n","996  {'id': '9eb87e95-3217-477f-9144-2f283ade150d',...   \n","997  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","998  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","999  {'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...   \n","\n","                                                device  \\\n","0    {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","1    {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","2    {'id': '9db35b11-1ea4-4bc2-8800-bd51125965c4',...   \n","3    {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","4    {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","..                                                 ...   \n","995  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","996  {'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...   \n","997  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","998  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","999  {'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...   \n","\n","                                               country  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                region  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                                  city  \\\n","0                                                 None   \n","1                                                 None   \n","2                                                 None   \n","3                                                 None   \n","4                                                 None   \n","..                                                 ...   \n","995                                               None   \n","996  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...   \n","997                                               None   \n","998                                               None   \n","999                                               None   \n","\n","                                             districts  \n","0                                                   []  \n","1                                                   []  \n","2                                                   []  \n","3                                                   []  \n","4                                                   []  \n","..                                                 ...  \n","995                                                 []  \n","996  [{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...  \n","997                                                 []  \n","998                                                 []  \n","999                                                 []  \n","\n","[1000 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-f025aacc-6731-4d9a-bea9-cdabda8556d3\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>serial_number</th>\n","      <th>message</th>\n","      <th>message_type</th>\n","      <th>label</th>\n","      <th>mediation_status</th>\n","      <th>status</th>\n","      <th>state</th>\n","      <th>address</th>\n","      <th>area</th>\n","      <th>...</th>\n","      <th>price_type</th>\n","      <th>plan_number</th>\n","      <th>identical_message_count</th>\n","      <th>contact</th>\n","      <th>group</th>\n","      <th>device</th>\n","      <th>country</th>\n","      <th>region</th>\n","      <th>city</th>\n","      <th>districts</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>9f68fd95-515b-4c20-bf1b-9f1f2c7e5189</td>\n","      <td>M-25-07-0048479</td>\n","      <td>للبيع ارض الهجرة ب  مساحة ٤٥٠م رقم  شارع ٢٥غرب...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f4b4502-39da-446e-a812-71219453c73e',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>9f68fd6e-d4d9-4b33-acc3-6c94c4c526d0</td>\n","      <td>M-25-07-0048478</td>\n","      <td>قصدك تبغى العرض هذابنفس الآلية</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9db44895-167b-47e1-806b-eb3dcdc6836b',...</td>\n","      <td>None</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>9f68fd6c-9b19-4585-acb9-18dd29be4f11</td>\n","      <td>M-25-07-0048477</td>\n","      <td>🔴فيلا للبيع كامله أو أدوار مستقله🔴  الرياض مخط...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f5466a3-2ac1-44f1-87da-f46d9e6a394e',...</td>\n","      <td>{'id': '9e6cfe6a-90a9-469c-9bb7-9744c3cb8e03',...</td>\n","      <td>{'id': '9db35b11-1ea4-4bc2-8800-bd51125965c4',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>9f68fd0f-f3c9-4b76-ac25-a175256fd76b</td>\n","      <td>M-25-07-0048476</td>\n","      <td>للبيع قطعة ارض في مخطط الهجره  ( ج )  رقم الار...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9eaac8d6-3e4a-475b-842a-8d7819049a28',...</td>\n","      <td>{'id': '9f3ef0e1-65e3-4d3d-8567-ff7fecc4cc40',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>9f68fcae-adc9-48e1-8482-30915ac290bb</td>\n","      <td>M-25-07-0048475</td>\n","      <td>السلام عليكم   مساء الخير    مطلوب عقارات مدرّ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>new</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f68fcae-abac-4b25-ab46-881e0534ba76',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>995</th>\n","      <td>9f580ed0-3a05-4cc6-84c8-23c93bad806d</td>\n","      <td>M-25-07-0046252</td>\n","      <td>الراجحي  قطعتين متجاوره  مساحة كل قطعة 344.5 م...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f450119-5029-4bc2-8e86-101d686b8a70',...</td>\n","      <td>{'id': '9db35b50-df82-4a00-97c4-aec45e874c83',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>996</th>\n","      <td>9f580cc2-ff11-4071-80dd-6a1e9f5b9f98</td>\n","      <td>M-25-07-0046251</td>\n","      <td>فيه قطعه ارض في مخطط النخبه شرق الرياض النظيم ...</td>\n","      <td>offer</td>\n","      <td>عرض</td>\n","      <td>none</td>\n","      <td>realestate</td>\n","      <td>sale</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f318a0d-8a46-445f-b069-009402839b68',...</td>\n","      <td>{'id': '9eb87e95-3217-477f-9144-2f283ade150d',...</td>\n","      <td>{'id': '9ddd16e2-3a11-42a8-a6e3-bd72406e4a4e',...</td>\n","      <td>{'id': '9d9ec551-aa26-4be7-be17-b15d42291f6f',...</td>\n","      <td>{'id': '9da8c3ee-071d-4970-92c4-77aed865306f',...</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>[{'id': '9f59a4fe-d812-43de-b9c3-7c0110ce83a6'...</td>\n","    </tr>\n","    <tr>\n","      <th>997</th>\n","      <td>9f580c63-206d-4ec4-8777-ab40a538a572</td>\n","      <td>M-25-07-0046250</td>\n","      <td>⚡️ عرض مميز ⚡️  *للبيع برج تجاري إداري* – جدة ...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>998</th>\n","      <td>9f580c33-e867-4275-bc5c-4e0b11234f84</td>\n","      <td>M-25-07-0046249</td>\n","      <td>للببع مبنى عظم  في حي  السلامة ٢...&lt;br /&gt;\\nظهي...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f33c021-5de1-4664-8e8d-8c46e609e1cd',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>999</th>\n","      <td>9f580838-4b60-4a03-92e2-c1cea2de09ba</td>\n","      <td>M-25-07-0046247</td>\n","      <td>🌟عماره تجارية للبيع 🌟 في مكه المكرمة - العزيزي...</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>none</td>\n","      <td>archived</td>\n","      <td>none</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>{'id': '9f580838-49a4-47d9-80a7-38450b945dc4',...</td>\n","      <td>{'id': '9f4a6890-9ccb-4dda-a9f7-857f9af091f6',...</td>\n","      <td>{'id': '9db359c0-fdb5-4163-ac36-cfbb97a0fda8',...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>[]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1000 rows × 21 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f025aacc-6731-4d9a-bea9-cdabda8556d3')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-f025aacc-6731-4d9a-bea9-cdabda8556d3 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-f025aacc-6731-4d9a-bea9-cdabda8556d3');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-6fb9f609-90dd-4e17-9682-0c07ae02d005\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-6fb9f609-90dd-4e17-9682-0c07ae02d005')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-6fb9f609-90dd-4e17-9682-0c07ae02d005 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_0215881c-28c2-43de-a932-f19260b3fe3e\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_0215881c-28c2-43de-a932-f19260b3fe3e button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df"}},"metadata":{},"execution_count":347}],"source":["df = df.dropna(subset=['label'])\n","df"]},{"cell_type":"code","execution_count":348,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":742},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1754331144646,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"0OdTayXLfThl","outputId":"61a746b1-ba59-4771-b215-9a3824e3fe87"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["id                           0\n","serial_number                0\n","message                      0\n","message_type                 0\n","label                        0\n","mediation_status             0\n","status                       0\n","state                        0\n","address                    823\n","area                       509\n","price                      579\n","price_type                 578\n","plan_number                904\n","identical_message_count      0\n","contact                      0\n","group                        4\n","device                       2\n","country                    502\n","region                     502\n","city                       504\n","districts                    0\n","dtype: int64"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>id</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>serial_number</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>message</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>message_type</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>label</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>mediation_status</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>status</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>state</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>address</th>\n","      <td>823</td>\n","    </tr>\n","    <tr>\n","      <th>area</th>\n","      <td>509</td>\n","    </tr>\n","    <tr>\n","      <th>price</th>\n","      <td>579</td>\n","    </tr>\n","    <tr>\n","      <th>price_type</th>\n","      <td>578</td>\n","    </tr>\n","    <tr>\n","      <th>plan_number</th>\n","      <td>904</td>\n","    </tr>\n","    <tr>\n","      <th>identical_message_count</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>contact</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>group</th>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>device</th>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>country</th>\n","      <td>502</td>\n","    </tr>\n","    <tr>\n","      <th>region</th>\n","      <td>502</td>\n","    </tr>\n","    <tr>\n","      <th>city</th>\n","      <td>504</td>\n","    </tr>\n","    <tr>\n","      <th>districts</th>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div><br><label><b>dtype:</b> int64</label>"]},"metadata":{},"execution_count":348}],"source":["df.isnull().sum()"]},{"cell_type":"code","execution_count":349,"metadata":{"id":"43XxNk8V87fG","executionInfo":{"status":"ok","timestamp":1754331144668,"user_tz":-180,"elapsed":21,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# Cleaning rows from NaN values\n","df = df[df['city'].notnull()]\n","df = df[df['state'].notnull()]\n","df = df[df['area'].notnull()]\n","df = df[df['id'].notnull()]"]},{"cell_type":"code","source":["df = df[df['label'] != 'none']"],"metadata":{"id":"xsJPRxAE12qS","executionInfo":{"status":"ok","timestamp":1754331144675,"user_tz":-180,"elapsed":5,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":350,"outputs":[]},{"cell_type":"code","execution_count":351,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":676},"executionInfo":{"elapsed":52,"status":"ok","timestamp":1754331144723,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"Er07bZnv9Flk","outputId":"19c6faff-d8a4-4a58-ba85-dd915202349f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id  \\\n","971  9f58dbdd-6935-471d-8ee1-939617e20699   \n","972  9f58c92c-16c2-4979-bcfb-a35e6d106532   \n","973  9f58c277-2c28-4aab-81fa-23d6b778b67d   \n","974  9f58b479-e81e-4658-b17f-5d558edb1728   \n","975  9f58ac98-b7b7-4bd0-a53a-be366df76ab2   \n","976  9f58ac47-dcf4-4cad-bdd7-17b083b99a6b   \n","977  9f588ae2-229c-4637-a1c6-773e2e4173b7   \n","978  9f587f87-b722-4492-b7ed-d0d85d2e1486   \n","979  9f587ba3-53c1-41ee-bdaa-f12b7743a27f   \n","980  9f586b88-2343-4025-8081-264fe95cee37   \n","981  9f585cac-e018-421a-ac0c-efecda9328e8   \n","983  9f58245b-1d5b-43f7-ba17-8243f86b3750   \n","985  9f5820e4-517b-4936-b7a9-ed9de94ebe1d   \n","986  9f581fa1-6d38-4b49-a30f-a193dda54d55   \n","988  9f581a08-2b2e-490d-b89c-74fb86900a8e   \n","989  9f581a07-3194-410a-a26e-a88abde9d74f   \n","990  9f5818a6-956d-46e9-8d07-911a0cfccd29   \n","991  9f58189a-b9eb-476d-92b3-7abdd1075e3c   \n","992  9f5814dc-9ad5-433f-bad7-1f83b18b473e   \n","993  9f581096-576e-4bf2-a24f-958eeee04c9b   \n","\n","                                               message label  \\\n","971  للبيع شرق الرياض قـطعه ممتازه في مخطط العقاريه...   عرض   \n","972  للبيع أرض زاوية [تجارية] حي( الصحافة) المساحه ...   عرض   \n","973  🏨 فرصة استثمارية نادرة | للبيع برج فندقي فاخر ...   عرض   \n","974  للبيع / للايجار - برج مكتبي  الرياض - طريق الم...   عرض   \n","975  *للبيــــــــع فيلا بقيمه ارض راس بلوك على ثلا...   عرض   \n","976  للبيع سبعة فلل  حي يرموك   خمسة فلل من دورين و...   عرض   \n","977  فله دبلوكس بالدار البيضاء المساحه 220 الدور ال...   عرض   \n","978  مخطط ٣١٢٩  مساحه ٩٠٠ م  اطوال ٣٠*٣٠ شارع ١٥ غر...   عرض   \n","979  موجود فيلا  استثمارية في السويدي مساحة 506 طول...   عرض   \n","980  فرصه عقاريه بدخل فوق ال 9%  للبيع عماره تجاريه...   عرض   \n","981  ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...   عرض   \n","983  للبيع راس بلك سكني   الحي ملقاء العساكر   المس...   عرض   \n","985  للبيــــــــع فيلا في حي اشبيليا المساحه٦٢٥ ال...   عرض   \n","986  فله بحي الصحافه للبيع  مساحه ٣٩٠م عمرها  ١٢ سن...   عرض   \n","988  ( للبيع بحي المعذر راس بلك سكني ) كقيمة أرض مو...   عرض   \n","989  مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...   عرض   \n","990  مطلوب من المالك  ارض في مخطط النخبة المساحة من...   طلب   \n","991  السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...   طلب   \n","992  للبيع      : فيلا عدد٤ الحي     : المروج  المس...   عرض   \n","993  السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...   طلب   \n","\n","                                                  city       state        area  \n","971  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale      287.00  \n","972  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale      925.00  \n","973  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  investment     4550.00  \n","974  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        rent     1725.00  \n","975  {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...        sale     1560.00  \n","976  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale      220.00  \n","977  {'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...        sale      220.00  \n","978  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale      900.00  \n","979  {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...  investment      506.00  \n","980  {'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...        sale     1750.00  \n","981  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale  1000000.00  \n","983  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale     3600.00  \n","985  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale      625.00  \n","986  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale      390.00  \n","988  {'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...        sale    12162.00  \n","989  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale      918.00  \n","990  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale      500.00  \n","991  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale      700.00  \n","992  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale      250.00  \n","993  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale    10000.00  "],"text/html":["\n","  <div id=\"df-60e752fb-6da9-4d17-8231-c5ad17fdcc25\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>label</th>\n","      <th>city</th>\n","      <th>state</th>\n","      <th>area</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>971</th>\n","      <td>9f58dbdd-6935-471d-8ee1-939617e20699</td>\n","      <td>للبيع شرق الرياض قـطعه ممتازه في مخطط العقاريه...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>287.00</td>\n","    </tr>\n","    <tr>\n","      <th>972</th>\n","      <td>9f58c92c-16c2-4979-bcfb-a35e6d106532</td>\n","      <td>للبيع أرض زاوية [تجارية] حي( الصحافة) المساحه ...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>925.00</td>\n","    </tr>\n","    <tr>\n","      <th>973</th>\n","      <td>9f58c277-2c28-4aab-81fa-23d6b778b67d</td>\n","      <td>🏨 فرصة استثمارية نادرة | للبيع برج فندقي فاخر ...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>investment</td>\n","      <td>4550.00</td>\n","    </tr>\n","    <tr>\n","      <th>974</th>\n","      <td>9f58b479-e81e-4658-b17f-5d558edb1728</td>\n","      <td>للبيع / للايجار - برج مكتبي  الرياض - طريق الم...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>rent</td>\n","      <td>1725.00</td>\n","    </tr>\n","    <tr>\n","      <th>975</th>\n","      <td>9f58ac98-b7b7-4bd0-a53a-be366df76ab2</td>\n","      <td>*للبيــــــــع فيلا بقيمه ارض راس بلوك على ثلا...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...</td>\n","      <td>sale</td>\n","      <td>1560.00</td>\n","    </tr>\n","    <tr>\n","      <th>976</th>\n","      <td>9f58ac47-dcf4-4cad-bdd7-17b083b99a6b</td>\n","      <td>للبيع سبعة فلل  حي يرموك   خمسة فلل من دورين و...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>220.00</td>\n","    </tr>\n","    <tr>\n","      <th>977</th>\n","      <td>9f588ae2-229c-4637-a1c6-773e2e4173b7</td>\n","      <td>فله دبلوكس بالدار البيضاء المساحه 220 الدور ال...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...</td>\n","      <td>sale</td>\n","      <td>220.00</td>\n","    </tr>\n","    <tr>\n","      <th>978</th>\n","      <td>9f587f87-b722-4492-b7ed-d0d85d2e1486</td>\n","      <td>مخطط ٣١٢٩  مساحه ٩٠٠ م  اطوال ٣٠*٣٠ شارع ١٥ غر...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>900.00</td>\n","    </tr>\n","    <tr>\n","      <th>979</th>\n","      <td>9f587ba3-53c1-41ee-bdaa-f12b7743a27f</td>\n","      <td>موجود فيلا  استثمارية في السويدي مساحة 506 طول...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...</td>\n","      <td>investment</td>\n","      <td>506.00</td>\n","    </tr>\n","    <tr>\n","      <th>980</th>\n","      <td>9f586b88-2343-4025-8081-264fe95cee37</td>\n","      <td>فرصه عقاريه بدخل فوق ال 9%  للبيع عماره تجاريه...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaedc8-df7b-4dc2-b6a7-59fefea68c87',...</td>\n","      <td>sale</td>\n","      <td>1750.00</td>\n","    </tr>\n","    <tr>\n","      <th>981</th>\n","      <td>9f585cac-e018-421a-ac0c-efecda9328e8</td>\n","      <td>ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>1000000.00</td>\n","    </tr>\n","    <tr>\n","      <th>983</th>\n","      <td>9f58245b-1d5b-43f7-ba17-8243f86b3750</td>\n","      <td>للبيع راس بلك سكني   الحي ملقاء العساكر   المس...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>3600.00</td>\n","    </tr>\n","    <tr>\n","      <th>985</th>\n","      <td>9f5820e4-517b-4936-b7a9-ed9de94ebe1d</td>\n","      <td>للبيــــــــع فيلا في حي اشبيليا المساحه٦٢٥ ال...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>625.00</td>\n","    </tr>\n","    <tr>\n","      <th>986</th>\n","      <td>9f581fa1-6d38-4b49-a30f-a193dda54d55</td>\n","      <td>فله بحي الصحافه للبيع  مساحه ٣٩٠م عمرها  ١٢ سن...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>390.00</td>\n","    </tr>\n","    <tr>\n","      <th>988</th>\n","      <td>9f581a08-2b2e-490d-b89c-74fb86900a8e</td>\n","      <td>( للبيع بحي المعذر راس بلك سكني ) كقيمة أرض مو...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...</td>\n","      <td>sale</td>\n","      <td>12162.00</td>\n","    </tr>\n","    <tr>\n","      <th>989</th>\n","      <td>9f581a07-3194-410a-a26e-a88abde9d74f</td>\n","      <td>مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>918.00</td>\n","    </tr>\n","    <tr>\n","      <th>990</th>\n","      <td>9f5818a6-956d-46e9-8d07-911a0cfccd29</td>\n","      <td>مطلوب من المالك  ارض في مخطط النخبة المساحة من...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>500.00</td>\n","    </tr>\n","    <tr>\n","      <th>991</th>\n","      <td>9f58189a-b9eb-476d-92b3-7abdd1075e3c</td>\n","      <td>السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>700.00</td>\n","    </tr>\n","    <tr>\n","      <th>992</th>\n","      <td>9f5814dc-9ad5-433f-bad7-1f83b18b473e</td>\n","      <td>للبيع      : فيلا عدد٤ الحي     : المروج  المس...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>250.00</td>\n","    </tr>\n","    <tr>\n","      <th>993</th>\n","      <td>9f581096-576e-4bf2-a24f-958eeee04c9b</td>\n","      <td>السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>10000.00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-60e752fb-6da9-4d17-8231-c5ad17fdcc25')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-60e752fb-6da9-4d17-8231-c5ad17fdcc25 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-60e752fb-6da9-4d17-8231-c5ad17fdcc25');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-7b2d3af9-f11e-4ca9-bbf9-efc6cb183af5\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-7b2d3af9-f11e-4ca9-bbf9-efc6cb183af5')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-7b2d3af9-f11e-4ca9-bbf9-efc6cb183af5 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"cleaned_df\",\n  \"rows\": 20,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 20,\n        \"samples\": [\n          \"9f58dbdd-6935-471d-8ee1-939617e20699\",\n          \"9f58189a-b9eb-476d-92b3-7abdd1075e3c\",\n          \"9f581a07-3194-410a-a26e-a88abde9d74f\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"message\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 20,\n        \"samples\": [\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0634\\u0631\\u0642 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636 \\u0642\\u0640\\u0637\\u0639\\u0647 \\u0645\\u0645\\u062a\\u0627\\u0632\\u0647 \\u0641\\u064a \\u0645\\u062e\\u0637\\u0637 \\u0627\\u0644\\u0639\\u0642\\u0627\\u0631\\u064a\\u0647 \\u0628\\u0627\\u0631\\u0643 <br />\\n\\u0645\\u0633\\u0627\\u062d\\u062a\\u0647\\u0627 :\\u0662\\u0668\\u0667  \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 :\\u0661\\u0668 \\u0634\\u0645\\u0627\\u0644\\u064a \\u0648\\u0645\\u0645\\u0631 \\u0642\\u0631\\u064a\\u0628\\u0647 \\u0645\\u0646 \\u0645\\u0631\\u0627\\u0642\\u0642 <br />\\n\\u0627\\u0644\\u0628\\u064a\\u0639 : \\u0662\\u0662\\u0660\\u0660 \\u0648\\u0644\\u0644\\u0635\\u0627\\u0645\\u0644 \\u0645\\u0627\\u064a\\u062e\\u062a\\u0644\\u0641 \\u0645\\u0639\\u0647   \\u0645\\u0639 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0640\\u0644  \\u0627\\u0645 \\u0631\\u064a\\u0640\\u0645<br />\\n\\u0627\\u0644\\u0639\\u062c\\u0645\\u064a  \\u0641\\u0627\\u0644 : 110177052\",\n          \"\\u0627\\u0644\\u0633\\u0644\\u0627\\u0645 \\u0639\\u0644\\u064a\\u0643\\u0645 \\u0648\\u0631\\u062d\\u0645\\u0629 \\u0627\\u0644\\u0644\\u0647 \\u0648\\u0628\\u0631\\u0643\\u0627\\u062a\\u0647 \\u0645\\u0637\\u0644\\u0648\\u0628 \\u0641\\u064a\\u0644\\u0627 \\u0641\\u064a \\u0627\\u0644\\u0627\\u062d\\u064a\\u0627\\u0621<br />\\n\\u0627\\u0644\\u0631\\u064a\\u0627\\u0646  \\u0627\\u0644\\u0631\\u0648\\u0627\\u0628\\u064a \\u0627\\u0644\\u0631\\u0648\\u0636\\u0629 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0629 \\u0645\\u0646 \\u0666\\u0660\\u0660 \\u0627\\u0644\\u0649 \\u0667\\u0660\\u0660 \\u0645 \\u0628\\u062d\\u062f\\u0648\\u062f \\u0663<br />\\n\\u0645\\u0644\\u064a\\u0648\\u0646 \\u0648\\u0646\\u0635\\u0641\",\n          \"\\u0645\\u062c\\u0645\\u0648\\u0639\\u0629 \\\" \\u0639\\u0642\\u0627\\u0631\\u062a \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636 \\ud83c\\udfe0 \\\"  \\u0639\\u0631\\u0636 \\u0641\\u0631\\u0635\\u0647 \\u0645\\u0645\\u064a\\u0632\\u0647 \\u062a\\u062c\\u0627\\u0631\\u064a \\u062d\\u064a<br />\\n\\u0627\\u0644\\u0639\\u0627\\u0631\\u0636 \\u062c\\u0646\\u0648\\u0628 \\u062e\\u0627\\u0644\\u062f \\u0628\\u0646 \\u0628\\u0646\\u062f\\u0631   \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 / 918  30 \\u0634\\u0631\\u0642\\u064a  \\u062a\\u0646\\u0641\\u0639<br />\\n\\u0645\\u0634\\u0631\\u0648\\u0639 \\u0634\\u0642\\u0642 \\u0627\\u0644\\u0627\\u0637\\u0648\\u0627\\u0644 / 34 * 27   \\u0627\\u0644\\u0628\\u064a\\u0639 / 8500 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0634\\u0648\\u0631  \\u0627\\u0644\\u0639\\u0631\\u0636<br />\\n\\u0645\\u0628\\u0627\\u0634\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0645\\u0627\\u0644\\u0643  \\u0644\\u0644\\u062a\\u0648\\u0627\\u0635\\u0644 :  0542240952\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"\\u0637\\u0644\\u0628\",\n          \"\\u0639\\u0631\\u0636\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"state\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"sale\",\n          \"investment\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"area\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 19,\n        \"samples\": [\n          \"287.00\",\n          \"220.00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":351}],"source":["# Selection for important rows and add them in new DF >>>>> cleaned_df\n","cleaned_df= df[['id','message', 'label', 'city','state', 'area']]\n","cleaned_df.tail(20)"]},{"cell_type":"code","execution_count":352,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1754331144735,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"35en5AhH9cjC","outputId":"e95776a0-fc79-4d92-9cd7-891146623fa8"},"outputs":[{"output_type":"stream","name":"stdout","text":["label\n","عرض    374\n","طلب     71\n","Name: count, dtype: int64\n"]}],"source":["print(cleaned_df['label'].value_counts())"]},{"cell_type":"code","execution_count":353,"metadata":{"executionInfo":{"elapsed":17,"status":"ok","timestamp":1754331144787,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"qbo1utJIg7FM"},"outputs":[],"source":["# Auto Labeling\n","# Classify message(Feature) to extract طلب ولا عرض and add it in label\n","\n","def extract_label(message):\n","    if pd.isna(message):\n","        return None\n","    text = message.strip()\n","\n","    if re.search(r'\\b(للبيع|عرض|يوجد)\\b', text):\n","        return 'عرض'\n","    elif re.search(r'\\b(مطلوب|نشتري|شراء)\\b', text):\n","        return 'طلب'\n","    else:\n","        return None\n","\n","cleaned_df.loc[:, 'label'] = cleaned_df['message'].apply(extract_label)"]},{"cell_type":"code","source":["print(cleaned_df['label'].value_counts())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DS2lE9UJVdrD","executionInfo":{"status":"ok","timestamp":1754331144794,"user_tz":-180,"elapsed":6,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"a09eca2c-78f9-4dee-bbd2-89537645efbb"},"execution_count":354,"outputs":[{"output_type":"stream","name":"stdout","text":["label\n","عرض    248\n","طلب     54\n","Name: count, dtype: int64\n"]}]},{"cell_type":"markdown","metadata":{"id":"ykue8z2F_bzm"},"source":["remove emojis"]},{"cell_type":"code","execution_count":355,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1754331144801,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"Wr0PSydYIYxD","outputId":"16b2fd13-2b0c-4ad6-a677-e87133f2470e"},"outputs":[{"output_type":"stream","name":"stdout","text":["                                      id  \\\n","6   9f67e14b-0f47-4cdd-93c9-4df7aef34e18   \n","11  9f67db6b-fac6-41e0-ac93-9709763e2cd5   \n","12  9f67d8d3-769b-4031-af47-574805e3cec9   \n","13  9f67d8cb-855e-4b74-a44c-07c21349dd90   \n","14  9f67d8c5-84f7-47d0-8ecd-3876a4dcc360   \n","\n","                                              message label  \\\n","6   فرررررررررصة للمطورين والمستثمرين للبيــــــــ...  None   \n","11  https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...   عرض   \n","12  https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...   عرض   \n","13  https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...   عرض   \n","14  للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...  None   \n","\n","                                                 city       state     area  \n","6   {'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...  investment  4288.00  \n","11  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale  1720.00  \n","12  {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...        sale   375.00  \n","13  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale   500.00  \n","14  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale   324.00  \n"]}],"source":["print(cleaned_df.head())"]},{"cell_type":"code","execution_count":356,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":30,"status":"ok","timestamp":1754331144832,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"J3SNCV2bdoZh","outputId":"61e1ce3a-8bdd-49c6-b6f2-484eea9cfc08"},"outputs":[{"output_type":"stream","name":"stdout","text":["Index(['id', 'message', 'label', 'city', 'state', 'area'], dtype='object')\n"]}],"source":["print(cleaned_df.columns)"]},{"cell_type":"markdown","metadata":{"id":"nsQvcdrrYYDE"},"source":["# ***Full Cleaning for text***\n","\n","\n","\n","\n","\n","\n","\n"]},{"cell_type":"code","source":["def full_clean(message):\n","    if not isinstance(message, str):\n","        return \"\"\n","\n","    # message = remove_broken_google_maps_links(message)\n","\n","    text = re.sub(r'(\\d[\\d\\.,]*)\\s*(ريال|جنية|SAR|EGP|درهم|الف|دولار|ألف|مليون|بليون|الاف|ملايين|للف|مليونين|مليونات|مليون ونص|مليون و نص)', '[]', message, flags=re.IGNORECASE)\n","    text = re.sub(r'\\b\\d{4,10}\\b', '[]', text)\n","\n","    text = re.sub(r'\\b(05\\d{8}|9665\\d{8}|01\\d{9})\\b', '[]', text)\n","    text = re.sub(r'\\b\\d{7,8}\\b', '[]', text)\n","\n","    text = re.sub(r'[\\u064B-\\u0652]', '', text)\n","\n","    text = re.sub(r'[^\\w\\s]', '', text)\n","\n","    text = re.sub(r'(.)\\1{2,}', r'\\1', text)\n","\n","    return text\n","cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(full_clean)"],"metadata":{"id":"HV9EDvBNrGGb","executionInfo":{"status":"ok","timestamp":1754331144857,"user_tz":-180,"elapsed":24,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"28a34c12-44a2-40a1-b0c8-b35b76e843c0"},"execution_count":357,"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-299844930.py:20: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(full_clean)\n"]}]},{"cell_type":"code","source":["def extract_links(text):\n","    if not isinstance(text, str):\n","        return None\n","\n","    pattern = r'(https?://\\S+|www\\.\\S+|\\S+\\.(com|net|org|ly|link|gl|app)\\S*)'\n","    matches = re.findall(pattern, text)\n","    links = [match[0] if isinstance(match, tuple) else match for match in matches]\n","\n","    return links if links else None"],"metadata":{"id":"_28bC9BuMy-1","executionInfo":{"status":"ok","timestamp":1754331144875,"user_tz":-180,"elapsed":19,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":358,"outputs":[]},{"cell_type":"code","source":["def remove_links(text):\n","    if not isinstance(text, str):\n","        return text\n","\n","    pattern = r'(https?://(?:www\\.)?(?:goo\\.gl/maps|maps\\.app\\.goo\\.gl|maps\\.google\\.com)/\\S+|https?maps?app?goo?gl\\S+|wa\\.link/\\S+|\\S+\\.(com|net|org|ly|link|gl|app)\\S*)'\n","    return re.sub(pattern, '', text).strip()\n"],"metadata":{"id":"ILRyPIj-sjBb","executionInfo":{"status":"ok","timestamp":1754331144890,"user_tz":-180,"elapsed":2,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":359,"outputs":[]},{"cell_type":"code","source":["cleaned_df['extracted_links'] = cleaned_df['message'].apply(extract_links)\n","cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(remove_links)\n","\n","cleaned_df['extracted_links'] = cleaned_df['message'].apply(extract_links)\n","\n","cleaned_df['extracted_links'] = cleaned_df['extracted_links'].apply(lambda x: 'no link' if x is None else x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IuSiO-hwQDzG","executionInfo":{"status":"ok","timestamp":1754331144960,"user_tz":-180,"elapsed":67,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"a47593c6-0646-475c-9c08-26ab72596b43"},"execution_count":360,"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-1905019557.py:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['extracted_links'] = cleaned_df['message'].apply(extract_links)\n","/tmp/ipython-input-1905019557.py:2: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(remove_links)\n","/tmp/ipython-input-1905019557.py:4: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['extracted_links'] = cleaned_df['message'].apply(extract_links)\n","/tmp/ipython-input-1905019557.py:6: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['extracted_links'] = cleaned_df['extracted_links'].apply(lambda x: 'no link' if x is None else x)\n"]}]},{"cell_type":"code","source":["cleaned_df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":964},"id":"utaIArdKslgX","executionInfo":{"status":"ok","timestamp":1754331145032,"user_tz":-180,"elapsed":75,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"03f77aeb-3f2a-40fd-8518-28d83c45a6f5"},"execution_count":361,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id  \\\n","6    9f67e14b-0f47-4cdd-93c9-4df7aef34e18   \n","11   9f67db6b-fac6-41e0-ac93-9709763e2cd5   \n","12   9f67d8d3-769b-4031-af47-574805e3cec9   \n","13   9f67d8cb-855e-4b74-a44c-07c21349dd90   \n","14   9f67d8c5-84f7-47d0-8ecd-3876a4dcc360   \n","..                                    ...   \n","989  9f581a07-3194-410a-a26e-a88abde9d74f   \n","990  9f5818a6-956d-46e9-8d07-911a0cfccd29   \n","991  9f58189a-b9eb-476d-92b3-7abdd1075e3c   \n","992  9f5814dc-9ad5-433f-bad7-1f83b18b473e   \n","993  9f581096-576e-4bf2-a24f-958eeee04c9b   \n","\n","                                               message label  \\\n","6    فرررررررررصة للمطورين والمستثمرين للبيــــــــ...  None   \n","11   https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...   عرض   \n","12   https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...   عرض   \n","13   https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...   عرض   \n","14   للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...  None   \n","..                                                 ...   ...   \n","989  مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...   عرض   \n","990  مطلوب من المالك  ارض في مخطط النخبة المساحة من...   طلب   \n","991  السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...   طلب   \n","992  للبيع      : فيلا عدد٤ الحي     : المروج  المس...   عرض   \n","993  السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...   طلب   \n","\n","                                                  city       state      area  \\\n","6    {'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...  investment   4288.00   \n","11   {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale   1720.00   \n","12   {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...        sale    375.00   \n","13   {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    500.00   \n","14   {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    324.00   \n","..                                                 ...         ...       ...   \n","989  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale    918.00   \n","990  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    500.00   \n","991  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    700.00   \n","992  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale    250.00   \n","993  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale  10000.00   \n","\n","                             cleaned_message_for_model  \\\n","6    فرررررررررصة للمطورين والمستثمرين للبيــــــــ...   \n","11   للبيع عماره راس بلوك ع<br />\\nالتخصصي حي النخي...   \n","12   للبيع فيلا<br />\\nجديدة بحي المهدية   مساحة 37...   \n","13   للبيع فيلا بقيمه ارض في حي<br />\\nالملك فيصل ع...   \n","14   للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...   \n","..                                                 ...   \n","989  مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...   \n","990  مطلوب من المالك  ارض في مخطط النخبة المساحة من...   \n","991  السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...   \n","992  للبيع      : فيلا عدد٤ الحي     : المروج  المس...   \n","993  السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...   \n","\n","                                       extracted_links  \n","6    [https://maps.app.goo.gl/fQebZ3m8UUvfXUHH6?g_s...  \n","11   [https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_s...  \n","12   [https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_s...  \n","13   [https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_s...  \n","14   [https://maps.app.goo.gl/xFPofkKTbTXM7WUB7?g_s...  \n","..                                                 ...  \n","989                                            no link  \n","990                                            no link  \n","991                                            no link  \n","992                                            no link  \n","993                                            no link  \n","\n","[445 rows x 8 columns]"],"text/html":["\n","  <div id=\"df-26bd7e39-e9d0-45e1-97ef-71a731504597\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>label</th>\n","      <th>city</th>\n","      <th>state</th>\n","      <th>area</th>\n","      <th>cleaned_message_for_model</th>\n","      <th>extracted_links</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>6</th>\n","      <td>9f67e14b-0f47-4cdd-93c9-4df7aef34e18</td>\n","      <td>فرررررررررصة للمطورين والمستثمرين للبيــــــــ...</td>\n","      <td>None</td>\n","      <td>{'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...</td>\n","      <td>investment</td>\n","      <td>4288.00</td>\n","      <td>فرررررررررصة للمطورين والمستثمرين للبيــــــــ...</td>\n","      <td>[https://maps.app.goo.gl/fQebZ3m8UUvfXUHH6?g_s...</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>9f67db6b-fac6-41e0-ac93-9709763e2cd5</td>\n","      <td>https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>1720.00</td>\n","      <td>للبيع عماره راس بلوك ع&lt;br /&gt;\\nالتخصصي حي النخي...</td>\n","      <td>[https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_s...</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>9f67d8d3-769b-4031-af47-574805e3cec9</td>\n","      <td>https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...</td>\n","      <td>sale</td>\n","      <td>375.00</td>\n","      <td>للبيع فيلا&lt;br /&gt;\\nجديدة بحي المهدية   مساحة 37...</td>\n","      <td>[https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_s...</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>9f67d8cb-855e-4b74-a44c-07c21349dd90</td>\n","      <td>https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>500.00</td>\n","      <td>للبيع فيلا بقيمه ارض في حي&lt;br /&gt;\\nالملك فيصل ع...</td>\n","      <td>[https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_s...</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>9f67d8c5-84f7-47d0-8ecd-3876a4dcc360</td>\n","      <td>للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...</td>\n","      <td>None</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>324.00</td>\n","      <td>للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...</td>\n","      <td>[https://maps.app.goo.gl/xFPofkKTbTXM7WUB7?g_s...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>989</th>\n","      <td>9f581a07-3194-410a-a26e-a88abde9d74f</td>\n","      <td>مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>918.00</td>\n","      <td>مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...</td>\n","      <td>no link</td>\n","    </tr>\n","    <tr>\n","      <th>990</th>\n","      <td>9f5818a6-956d-46e9-8d07-911a0cfccd29</td>\n","      <td>مطلوب من المالك  ارض في مخطط النخبة المساحة من...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>500.00</td>\n","      <td>مطلوب من المالك  ارض في مخطط النخبة المساحة من...</td>\n","      <td>no link</td>\n","    </tr>\n","    <tr>\n","      <th>991</th>\n","      <td>9f58189a-b9eb-476d-92b3-7abdd1075e3c</td>\n","      <td>السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>700.00</td>\n","      <td>السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...</td>\n","      <td>no link</td>\n","    </tr>\n","    <tr>\n","      <th>992</th>\n","      <td>9f5814dc-9ad5-433f-bad7-1f83b18b473e</td>\n","      <td>للبيع      : فيلا عدد٤ الحي     : المروج  المس...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>250.00</td>\n","      <td>للبيع      : فيلا عدد٤ الحي     : المروج  المس...</td>\n","      <td>no link</td>\n","    </tr>\n","    <tr>\n","      <th>993</th>\n","      <td>9f581096-576e-4bf2-a24f-958eeee04c9b</td>\n","      <td>السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>10000.00</td>\n","      <td>السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...</td>\n","      <td>no link</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>445 rows × 8 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-26bd7e39-e9d0-45e1-97ef-71a731504597')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-26bd7e39-e9d0-45e1-97ef-71a731504597 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-26bd7e39-e9d0-45e1-97ef-71a731504597');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-7e8cb3b1-2e46-4a40-82f7-12ab1dbd12e0\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-7e8cb3b1-2e46-4a40-82f7-12ab1dbd12e0')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-7e8cb3b1-2e46-4a40-82f7-12ab1dbd12e0 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_403d338f-fdda-443e-98eb-2d1a9e144f71\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('cleaned_df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_403d338f-fdda-443e-98eb-2d1a9e144f71 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('cleaned_df');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"cleaned_df","summary":"{\n  \"name\": \"cleaned_df\",\n  \"rows\": 445,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 445,\n        \"samples\": [\n          \"9f5c4a96-6df7-476c-81bc-e47f002317f5\",\n          \"9f5b2528-51f1-4d8e-b40a-9ba954cd3cbc\",\n          \"9f621d4b-9339-4011-8172-f8f1d5cbe9df\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"message\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 445,\n        \"samples\": [\n          \"\\ud83d\\udd38 \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0629 \\ud83d\\udd38 \\ud83d\\udd39 \\u0627\\u0644\\u0645\\u0648\\u0642\\u0639 : \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636 \\u062d\\u064a \\u0627\\u0644\\u062c\\u0646\\u0627\\u062f\\u0631\\u064a\\u0629 <br />\\n\\ud83d\\udd39 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0629 : 1000\\u0645  \\ud83d\\udd39 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 : 40\\u0645 \\u0634\\u0645\\u0627\\u0644\\u064a  \\ud83d\\udd39 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0634\\u064a\\u062e<br />\\n\\u062e\\u0644\\u064a\\u0641\\u0629 \\u0627\\u0644 \\u062b\\u0627\\u0646\\u064a  \\ud83d\\udd39 \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 : 40 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 * 25\\u0645  \\ud83d\\udd38 \\u0627\\u0644\\u0628\\u064a\\u0639 :<br />\\n3700 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0628\\u0625\\u0630\\u0646 \\u0627\\u0644\\u0644\\u0647 \\ud83d\\udd38  \\u0644\\u0640 \\u0627\\u0644\\u062a\\u0648\\u0627\\u0635\\u0644 / 0553197625 \\u0631\\u0642\\u0645 / \\u0662\\u0665\",\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u0641\\u064a \\u0645\\u062e\\u0637\\u0637 3134 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 900\\u0645\\u062a\\u0631  \\u0627\\u0637\\u0648\\u0627\\u0644 30\\u00d730 \\u0634\\u0627\\u0631\\u0639 20<br />\\n\\u063a\\u0631\\u0628\\u064a \\u0639\\u0644\\u0649 \\u062d\\u062f\\u0627\\u0626\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 530\",\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0642\\u0635\\u0631 \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0645\\u062d\\u0645\\u062f\\u064a\\u0629 \\u0627\\u0644\\u063a\\u0631\\u0628\\u064a \\u0627\\u062d\\u062f \\u0627\\u0631\\u0642\\u0649 \\u0627\\u062d\\u064a\\u0627\\u0621 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636.<br />\\n\\u0645\\u0633\\u0627\\u062d\\u0629 \\u0627\\u0644\\u0642\\u0635\\u0631 1800\\u0645 \\u0639\\u0645\\u0631 \\u0627\\u0644\\u0639\\u0642\\u0627\\u0631 8 \\u0633\\u0646\\u0648\\u0627\\u062a  \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 60 * 30 \\u0631\\u0627\\u0633 \\u0628\\u0644\\u0643<br />\\n\\u0639\\u0644\\u0649 \\u062b\\u0644\\u0627\\u062b \\u0634\\u0648\\u0627\\u0631\\u0639  \\u062c\\u0646\\u0648\\u0628\\u064a \\u060c \\u0634\\u0631\\u0642\\u064a \\u060c \\u063a\\u0631\\u0628\\u064a  \\u062c\\u0645\\u064a\\u0639 \\u0627\\u0644\\u0634\\u0648\\u0627\\u0631\\u0639 20<br />\\n\\u064a\\u062a\\u0643\\u0648\\u0646 \\u0627\\u0644\\u0642\\u0635\\u0631 \\u0645\\u0646 9 \\u0627\\u062c\\u0646\\u062d\\u0629 \\u0646\\u0648\\u0645 \\u0648\\u062b\\u0644\\u0627\\u062b \\u0635\\u0627\\u0644\\u0627\\u062a  \\u0648\\u0645\\u062c\\u0627\\u0644\\u0633 \\u0645\\u0633\\u062a\\u0642\\u0644\\u0629<br />\\n\\u0648\\u0645\\u062c\\u0627\\u0644\\u0633 \\u062e\\u0627\\u0631\\u062c\\u064a\\u0629  \\u0648\\u0645\\u0637\\u0628\\u062e \\u0631\\u0626\\u064a\\u0633\\u064a \\u0641\\u064a \\u0627\\u0644\\u0628\\u062f\\u0631\\u0648\\u0645 \\u0648\\u0645\\u0637\\u0628\\u062e \\u062e\\u0627\\u0631\\u062c\\u064a<br />\\n\\u0648\\u063a\\u0631\\u0641\\u0629 \\u062e\\u062f\\u0645 \\u0648\\u0633\\u0627\\u0626\\u0642\\u064a\\u0646 \\u0648\\u0645\\u0633\\u0628\\u062d \\u062f\\u0627\\u062e\\u0644\\u064a \\u0645\\u0641\\u062a\\u0648\\u062d  \\u0648\\u0635\\u0644 \\u0627\\u0644\\u0633\\u0648\\u0645 33 \\u0645\\u0644\\u064a\\u0648\\u0646 <br />\\n\\u062d\\u062f \\u0627\\u0644\\u0628\\u064a\\u0639 35 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0642\\u0627\\u0628\\u0644 \\u0644\\u0644\\u062a\\u0641\\u0627\\u0648\\u0636 \\u0627\\u0644\\u0628\\u0633\\u064a\\u0637   \\u062d\\u0635\\u0631\\u064a \\u0645\\u0646 \\u0648\\u0643\\u064a\\u0644<br />\\n\\u0627\\u0644\\u0627\\u0641\\u0631\\u0627\\u063a \\u0644\\u062f\\u0649 \\u0623\\u0639\\u064a\\u0627\\u0646 \\u0627\\u0644\\u0639\\u0642\\u0627\\u0631\\u064a\\u0629   <br />\\nhttps://maps.app.goo.gl/Wxe4fAgBT4mte3m78?g_st=ic\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"\\u0637\\u0644\\u0628\",\n          \"\\u0639\\u0631\\u0636\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"state\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"sale\",\n          \"rent\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"area\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 240,\n        \"samples\": [\n          \"418.00\",\n          \"5000.00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"cleaned_message_for_model\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 445,\n        \"samples\": [\n          \"\\ud83d\\udd38 \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0629 \\ud83d\\udd38 \\ud83d\\udd39 \\u0627\\u0644\\u0645\\u0648\\u0642\\u0639 : \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636 \\u062d\\u064a \\u0627\\u0644\\u062c\\u0646\\u0627\\u062f\\u0631\\u064a\\u0629 <br />\\n\\ud83d\\udd39 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0629 : 1000\\u0645  \\ud83d\\udd39 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 : 40\\u0645 \\u0634\\u0645\\u0627\\u0644\\u064a  \\ud83d\\udd39 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0634\\u064a\\u062e<br />\\n\\u062e\\u0644\\u064a\\u0641\\u0629 \\u0627\\u0644 \\u062b\\u0627\\u0646\\u064a  \\ud83d\\udd39 \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 : 40 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 * 25\\u0645  \\ud83d\\udd38 \\u0627\\u0644\\u0628\\u064a\\u0639 :<br />\\n3700 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0628\\u0625\\u0630\\u0646 \\u0627\\u0644\\u0644\\u0647 \\ud83d\\udd38  \\u0644\\u0640 \\u0627\\u0644\\u062a\\u0648\\u0627\\u0635\\u0644 / 0553197625 \\u0631\\u0642\\u0645 / \\u0662\\u0665\",\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u0641\\u064a \\u0645\\u062e\\u0637\\u0637 3134 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 900\\u0645\\u062a\\u0631  \\u0627\\u0637\\u0648\\u0627\\u0644 30\\u00d730 \\u0634\\u0627\\u0631\\u0639 20<br />\\n\\u063a\\u0631\\u0628\\u064a \\u0639\\u0644\\u0649 \\u062d\\u062f\\u0627\\u0626\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 530\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"extracted_links\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":361}]},{"cell_type":"markdown","metadata":{"id":"A22rN8VtwfQP"},"source":["# ***Data Extraction***"]},{"cell_type":"code","source":["def clean_message_for_model(message):\n","    if not isinstance(message, str):\n","        return \"\"\n","\n","    emoji_pattern = re.compile(\n","        r'['\n","        '\\U00010000-\\U0010FFFF'\n","        '\\U0001F600-\\U0001F64F'\n","        '\\U0001F900-\\U0001F9FF'\n","        ']',\n","        flags=re.UNICODE\n","    )\n","    message = message.replace(\"�\", \"\")\n","    message = emoji_pattern.sub('', message)\n","\n","    message = re.sub(r'(?:\\+966|00966|0)5\\d{8}', '[PHONE]', message)\n","    message = re.sub(r'(\\d{1,3}(?:[.,]?\\d{3})+|\\d+)\\s*(ألف|الف|مليون|دولار|جنيه|ج|ريال|ر\\.س)?', '[]', message)\n","    message = re.sub(r'[\\u064B-\\u0652]', '', message) # Tashkeel\n","    message = re.sub(r'[^\\w\\s]', '', message)\n","    message = re.sub(r'(.)\\1{2,}', r'\\1', message)\n","    return message\n","\n","cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(clean_message_for_model)"],"metadata":{"id":"xRXSItz7aaoV","executionInfo":{"status":"ok","timestamp":1754331145054,"user_tz":-180,"elapsed":24,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"0d4b45f4-b5c4-49e8-9489-13933b0f2c67"},"execution_count":362,"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-1540236986.py:23: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(clean_message_for_model)\n"]}]},{"cell_type":"code","source":["import re\n","\n","def remove_emojis(text):\n","    if not isinstance(text, str):\n","        return text\n","\n","    emoji_pattern = re.compile(\n","        \"[\"\n","        \"\\U0001F600-\\U0001F64F\"\n","        \"\\U0001F300-\\U0001F5FF\"\n","        \"\\U0001F680-\\U0001F6FF\"\n","        \"\\U0001F1E0-\\U0001F1FF\"\n","        \"\\U00002702-\\U000027B0\"\n","        \"\\U000024C2-\\U0001F251\"\n","        \"\\U0001F900-\\U0001F9FF\"\n","        \"\\U0001FA70-\\U0001FAFF\"\n","        \"\\U00002500-\\U00002BEF\"\n","        \"]+\",\n","        flags=re.UNICODE\n","    )\n","\n","    return emoji_pattern.sub(r'', text)\n","\n","cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(remove_emojis)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rq_EM8ojRgk6","executionInfo":{"status":"ok","timestamp":1754331145106,"user_tz":-180,"elapsed":53,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"603004e3-7527-4423-f90e-ccde5f0ff437"},"execution_count":363,"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-3366911685.py:24: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['cleaned_message_for_model'] = cleaned_df['message'].apply(remove_emojis)\n"]}]},{"cell_type":"code","source":["#City\n","def extract_city_name(city_cell):\n","    try:\n","        if isinstance(city_cell, str):\n","            city_cell = ast.literal_eval(city_cell)\n","\n","        if isinstance(city_cell, dict):\n","            translations = city_cell.get('translations', [])\n","            for item in translations:\n","                if item.get('locale') == 'ar':\n","                    return item.get('name')\n","\n","            return city_cell.get('name')\n","    except:\n","        return None\n","\n","cleaned_df['city_name'] = cleaned_df['city'].apply(extract_city_name)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"i7Vtxr8H8Pli","executionInfo":{"status":"ok","timestamp":1754331145111,"user_tz":-180,"elapsed":4,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"693382e6-51a3-4cd1-ef74-9e0d0ce8723e","collapsed":true},"execution_count":364,"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-1177003275.py:17: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['city_name'] = cleaned_df['city'].apply(extract_city_name)\n"]}]},{"cell_type":"code","source":["cleaned_df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":964},"id":"Mvfq0AI1qZkc","executionInfo":{"status":"ok","timestamp":1754331145193,"user_tz":-180,"elapsed":81,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"5760a1ec-7d81-4be8-87d3-a5d94e0c54ee","collapsed":true},"execution_count":365,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id  \\\n","6    9f67e14b-0f47-4cdd-93c9-4df7aef34e18   \n","11   9f67db6b-fac6-41e0-ac93-9709763e2cd5   \n","12   9f67d8d3-769b-4031-af47-574805e3cec9   \n","13   9f67d8cb-855e-4b74-a44c-07c21349dd90   \n","14   9f67d8c5-84f7-47d0-8ecd-3876a4dcc360   \n","..                                    ...   \n","989  9f581a07-3194-410a-a26e-a88abde9d74f   \n","990  9f5818a6-956d-46e9-8d07-911a0cfccd29   \n","991  9f58189a-b9eb-476d-92b3-7abdd1075e3c   \n","992  9f5814dc-9ad5-433f-bad7-1f83b18b473e   \n","993  9f581096-576e-4bf2-a24f-958eeee04c9b   \n","\n","                                               message label  \\\n","6    فرررررررررصة للمطورين والمستثمرين للبيــــــــ...  None   \n","11   https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...   عرض   \n","12   https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...   عرض   \n","13   https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...   عرض   \n","14   للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...  None   \n","..                                                 ...   ...   \n","989  مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...   عرض   \n","990  مطلوب من المالك  ارض في مخطط النخبة المساحة من...   طلب   \n","991  السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...   طلب   \n","992  للبيع      : فيلا عدد٤ الحي     : المروج  المس...   عرض   \n","993  السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...   طلب   \n","\n","                                                  city       state      area  \\\n","6    {'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...  investment   4288.00   \n","11   {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale   1720.00   \n","12   {'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...        sale    375.00   \n","13   {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    500.00   \n","14   {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    324.00   \n","..                                                 ...         ...       ...   \n","989  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale    918.00   \n","990  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    500.00   \n","991  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...        sale    700.00   \n","992  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale    250.00   \n","993  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...        sale  10000.00   \n","\n","                             cleaned_message_for_model  \\\n","6    فرررررررررصة للمطورين والمستثمرين للبيــــــــ...   \n","11   https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...   \n","12   https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...   \n","13   https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...   \n","14   للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...   \n","..                                                 ...   \n","989  مجموعة \" عقارت الرياض  \"  عرض فرصه مميزه تجاري...   \n","990  مطلوب من المالك  ارض في مخطط النخبة المساحة من...   \n","991  السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...   \n","992  للبيع      : فيلا عدد٤ الحي     : المروج  المس...   \n","993  السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...   \n","\n","                                       extracted_links    city_name  \n","6    [https://maps.app.goo.gl/fQebZ3m8UUvfXUHH6?g_s...   وسط الرياض  \n","11   [https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_s...  شمال الرياض  \n","12   [https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_s...   غرب الرياض  \n","13   [https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_s...   شرق الرياض  \n","14   [https://maps.app.goo.gl/xFPofkKTbTXM7WUB7?g_s...   شرق الرياض  \n","..                                                 ...          ...  \n","989                                            no link  شمال الرياض  \n","990                                            no link   شرق الرياض  \n","991                                            no link   شرق الرياض  \n","992                                            no link  شمال الرياض  \n","993                                            no link  شمال الرياض  \n","\n","[445 rows x 9 columns]"],"text/html":["\n","  <div id=\"df-92124496-4b2e-4c95-bda5-79a4867b825b\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>label</th>\n","      <th>city</th>\n","      <th>state</th>\n","      <th>area</th>\n","      <th>cleaned_message_for_model</th>\n","      <th>extracted_links</th>\n","      <th>city_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>6</th>\n","      <td>9f67e14b-0f47-4cdd-93c9-4df7aef34e18</td>\n","      <td>فرررررررررصة للمطورين والمستثمرين للبيــــــــ...</td>\n","      <td>None</td>\n","      <td>{'id': '9daaed88-718d-4822-b2fd-5c63377ba122',...</td>\n","      <td>investment</td>\n","      <td>4288.00</td>\n","      <td>فرررررررررصة للمطورين والمستثمرين للبيــــــــ...</td>\n","      <td>[https://maps.app.goo.gl/fQebZ3m8UUvfXUHH6?g_s...</td>\n","      <td>وسط الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>9f67db6b-fac6-41e0-ac93-9709763e2cd5</td>\n","      <td>https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>1720.00</td>\n","      <td>https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_st...</td>\n","      <td>[https://maps.app.goo.gl/2mrovDjeQVBtkHMCA?g_s...</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>9f67d8d3-769b-4031-af47-574805e3cec9</td>\n","      <td>https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaee00-3dd8-452d-a64f-fded6148d8f6',...</td>\n","      <td>sale</td>\n","      <td>375.00</td>\n","      <td>https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_st...</td>\n","      <td>[https://maps.app.goo.gl/WB1Suyyz8P6YB59P6?g_s...</td>\n","      <td>غرب الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>9f67d8cb-855e-4b74-a44c-07c21349dd90</td>\n","      <td>https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>500.00</td>\n","      <td>https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_st...</td>\n","      <td>[https://maps.app.goo.gl/JpEv6zP5wKWUHsmr5?g_s...</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>9f67d8c5-84f7-47d0-8ecd-3876a4dcc360</td>\n","      <td>للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...</td>\n","      <td>None</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>324.00</td>\n","      <td>للبيــــــــع قطعة أرض سكني  حي المونسية  مخطط...</td>\n","      <td>[https://maps.app.goo.gl/xFPofkKTbTXM7WUB7?g_s...</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>989</th>\n","      <td>9f581a07-3194-410a-a26e-a88abde9d74f</td>\n","      <td>مجموعة \" عقارت الرياض 🏠 \"  عرض فرصه مميزه تجار...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>918.00</td>\n","      <td>مجموعة \" عقارت الرياض  \"  عرض فرصه مميزه تجاري...</td>\n","      <td>no link</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>990</th>\n","      <td>9f5818a6-956d-46e9-8d07-911a0cfccd29</td>\n","      <td>مطلوب من المالك  ارض في مخطط النخبة المساحة من...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>500.00</td>\n","      <td>مطلوب من المالك  ارض في مخطط النخبة المساحة من...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>991</th>\n","      <td>9f58189a-b9eb-476d-92b3-7abdd1075e3c</td>\n","      <td>السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>700.00</td>\n","      <td>السلام عليكم ورحمة الله وبركاته مطلوب فيلا في ...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>992</th>\n","      <td>9f5814dc-9ad5-433f-bad7-1f83b18b473e</td>\n","      <td>للبيع      : فيلا عدد٤ الحي     : المروج  المس...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>250.00</td>\n","      <td>للبيع      : فيلا عدد٤ الحي     : المروج  المس...</td>\n","      <td>no link</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>993</th>\n","      <td>9f581096-576e-4bf2-a24f-958eeee04c9b</td>\n","      <td>السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>10000.00</td>\n","      <td>السلام عليكم ، مسيكم بالخير  مطلوب ارض مساحة 1...</td>\n","      <td>no link</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>445 rows × 9 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-92124496-4b2e-4c95-bda5-79a4867b825b')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-92124496-4b2e-4c95-bda5-79a4867b825b button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-92124496-4b2e-4c95-bda5-79a4867b825b');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-d723e0d2-5f25-4241-8894-57d5eab38f52\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-d723e0d2-5f25-4241-8894-57d5eab38f52')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-d723e0d2-5f25-4241-8894-57d5eab38f52 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_2fe6b2a9-e731-4b9c-958c-02d6ee21a11b\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('cleaned_df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_2fe6b2a9-e731-4b9c-958c-02d6ee21a11b button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('cleaned_df');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"cleaned_df","summary":"{\n  \"name\": \"cleaned_df\",\n  \"rows\": 445,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 445,\n        \"samples\": [\n          \"9f5c4a96-6df7-476c-81bc-e47f002317f5\",\n          \"9f5b2528-51f1-4d8e-b40a-9ba954cd3cbc\",\n          \"9f621d4b-9339-4011-8172-f8f1d5cbe9df\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"message\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 445,\n        \"samples\": [\n          \"\\ud83d\\udd38 \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0629 \\ud83d\\udd38 \\ud83d\\udd39 \\u0627\\u0644\\u0645\\u0648\\u0642\\u0639 : \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636 \\u062d\\u064a \\u0627\\u0644\\u062c\\u0646\\u0627\\u062f\\u0631\\u064a\\u0629 <br />\\n\\ud83d\\udd39 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0629 : 1000\\u0645  \\ud83d\\udd39 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 : 40\\u0645 \\u0634\\u0645\\u0627\\u0644\\u064a  \\ud83d\\udd39 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0634\\u064a\\u062e<br />\\n\\u062e\\u0644\\u064a\\u0641\\u0629 \\u0627\\u0644 \\u062b\\u0627\\u0646\\u064a  \\ud83d\\udd39 \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 : 40 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 * 25\\u0645  \\ud83d\\udd38 \\u0627\\u0644\\u0628\\u064a\\u0639 :<br />\\n3700 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0628\\u0625\\u0630\\u0646 \\u0627\\u0644\\u0644\\u0647 \\ud83d\\udd38  \\u0644\\u0640 \\u0627\\u0644\\u062a\\u0648\\u0627\\u0635\\u0644 / 0553197625 \\u0631\\u0642\\u0645 / \\u0662\\u0665\",\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u0641\\u064a \\u0645\\u062e\\u0637\\u0637 3134 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 900\\u0645\\u062a\\u0631  \\u0627\\u0637\\u0648\\u0627\\u0644 30\\u00d730 \\u0634\\u0627\\u0631\\u0639 20<br />\\n\\u063a\\u0631\\u0628\\u064a \\u0639\\u0644\\u0649 \\u062d\\u062f\\u0627\\u0626\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 530\",\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0642\\u0635\\u0631 \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0645\\u062d\\u0645\\u062f\\u064a\\u0629 \\u0627\\u0644\\u063a\\u0631\\u0628\\u064a \\u0627\\u062d\\u062f \\u0627\\u0631\\u0642\\u0649 \\u0627\\u062d\\u064a\\u0627\\u0621 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636.<br />\\n\\u0645\\u0633\\u0627\\u062d\\u0629 \\u0627\\u0644\\u0642\\u0635\\u0631 1800\\u0645 \\u0639\\u0645\\u0631 \\u0627\\u0644\\u0639\\u0642\\u0627\\u0631 8 \\u0633\\u0646\\u0648\\u0627\\u062a  \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 60 * 30 \\u0631\\u0627\\u0633 \\u0628\\u0644\\u0643<br />\\n\\u0639\\u0644\\u0649 \\u062b\\u0644\\u0627\\u062b \\u0634\\u0648\\u0627\\u0631\\u0639  \\u062c\\u0646\\u0648\\u0628\\u064a \\u060c \\u0634\\u0631\\u0642\\u064a \\u060c \\u063a\\u0631\\u0628\\u064a  \\u062c\\u0645\\u064a\\u0639 \\u0627\\u0644\\u0634\\u0648\\u0627\\u0631\\u0639 20<br />\\n\\u064a\\u062a\\u0643\\u0648\\u0646 \\u0627\\u0644\\u0642\\u0635\\u0631 \\u0645\\u0646 9 \\u0627\\u062c\\u0646\\u062d\\u0629 \\u0646\\u0648\\u0645 \\u0648\\u062b\\u0644\\u0627\\u062b \\u0635\\u0627\\u0644\\u0627\\u062a  \\u0648\\u0645\\u062c\\u0627\\u0644\\u0633 \\u0645\\u0633\\u062a\\u0642\\u0644\\u0629<br />\\n\\u0648\\u0645\\u062c\\u0627\\u0644\\u0633 \\u062e\\u0627\\u0631\\u062c\\u064a\\u0629  \\u0648\\u0645\\u0637\\u0628\\u062e \\u0631\\u0626\\u064a\\u0633\\u064a \\u0641\\u064a \\u0627\\u0644\\u0628\\u062f\\u0631\\u0648\\u0645 \\u0648\\u0645\\u0637\\u0628\\u062e \\u062e\\u0627\\u0631\\u062c\\u064a<br />\\n\\u0648\\u063a\\u0631\\u0641\\u0629 \\u062e\\u062f\\u0645 \\u0648\\u0633\\u0627\\u0626\\u0642\\u064a\\u0646 \\u0648\\u0645\\u0633\\u0628\\u062d \\u062f\\u0627\\u062e\\u0644\\u064a \\u0645\\u0641\\u062a\\u0648\\u062d  \\u0648\\u0635\\u0644 \\u0627\\u0644\\u0633\\u0648\\u0645 33 \\u0645\\u0644\\u064a\\u0648\\u0646 <br />\\n\\u062d\\u062f \\u0627\\u0644\\u0628\\u064a\\u0639 35 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0642\\u0627\\u0628\\u0644 \\u0644\\u0644\\u062a\\u0641\\u0627\\u0648\\u0636 \\u0627\\u0644\\u0628\\u0633\\u064a\\u0637   \\u062d\\u0635\\u0631\\u064a \\u0645\\u0646 \\u0648\\u0643\\u064a\\u0644<br />\\n\\u0627\\u0644\\u0627\\u0641\\u0631\\u0627\\u063a \\u0644\\u062f\\u0649 \\u0623\\u0639\\u064a\\u0627\\u0646 \\u0627\\u0644\\u0639\\u0642\\u0627\\u0631\\u064a\\u0629   <br />\\nhttps://maps.app.goo.gl/Wxe4fAgBT4mte3m78?g_st=ic\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"\\u0637\\u0644\\u0628\",\n          \"\\u0639\\u0631\\u0636\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"state\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"sale\",\n          \"rent\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"area\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 240,\n        \"samples\": [\n          \"418.00\",\n          \"5000.00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"cleaned_message_for_model\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 445,\n        \"samples\": [\n          \" \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0629   \\u0627\\u0644\\u0645\\u0648\\u0642\\u0639 : \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636 \\u062d\\u064a \\u0627\\u0644\\u062c\\u0646\\u0627\\u062f\\u0631\\u064a\\u0629 <br />\\n \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0629 : 1000\\u0645   \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 : 40\\u0645 \\u0634\\u0645\\u0627\\u0644\\u064a   \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0634\\u064a\\u062e<br />\\n\\u062e\\u0644\\u064a\\u0641\\u0629 \\u0627\\u0644 \\u062b\\u0627\\u0646\\u064a   \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 : 40 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 * 25\\u0645   \\u0627\\u0644\\u0628\\u064a\\u0639 :<br />\\n3700 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0628\\u0625\\u0630\\u0646 \\u0627\\u0644\\u0644\\u0647   \\u0644\\u0640 \\u0627\\u0644\\u062a\\u0648\\u0627\\u0635\\u0644 / 0553197625 \\u0631\\u0642\\u0645 / \\u0662\\u0665\",\n          \"\\u0644\\u0644\\u0628\\u064a\\u0639 \\u0627\\u0631\\u0636 \\u0641\\u064a \\u0645\\u062e\\u0637\\u0637 3134 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 900\\u0645\\u062a\\u0631  \\u0627\\u0637\\u0648\\u0627\\u0644 30\\u00d730 \\u0634\\u0627\\u0631\\u0639 20<br />\\n\\u063a\\u0631\\u0628\\u064a \\u0639\\u0644\\u0649 \\u062d\\u062f\\u0627\\u0626\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 530\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"extracted_links\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"\\u0634\\u0645\\u0627\\u0644 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636\",\n          \"\\u062c\\u0646\\u0648\\u0628 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":365}]},{"cell_type":"code","source":["cleaned_df['cleaned_message_for_model'].iloc[150]"],"metadata":{"id":"0SkOUsByDWN2","executionInfo":{"status":"ok","timestamp":1754331145197,"user_tz":-180,"elapsed":3,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"colab":{"base_uri":"https://localhost:8080/","height":70},"outputId":"0e76cf72-e89c-44b2-c046-2abf524c31cd"},"execution_count":366,"outputs":[{"output_type":"execute_result","data":{"text/plain":["' مشروع حي الربوة    *الدفع كاش فقط*     تفاصيل<br />\\nالمشروع: - *نموذج A*: 4 غرف مميزة   - *المساحة:* 142 م²   -<br />\\n*السعر:* 450,000 ريال   *آخر شقتين متاحتين!*   *الدور<br />\\nالأول* أو *الدور الرابع*   مميزات المشروع: - *ضمان 25 سنة*<br />\\nعلى القواطع - *ضمان 20 سنة* على الهيكل - *ضمان 5 سنوات* على<br />\\nالكهرباء والسباكة   *المشروع في مرحلة التشطيبات<br />\\nالنهائية!*   *للتواصل عبر واتساب:* +966 57 635 0846   لا تفوت<br />\\nالفرصة!'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":366}]},{"cell_type":"code","execution_count":367,"metadata":{"id":"hQk4pd1t7QFR","executionInfo":{"status":"ok","timestamp":1754331145199,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# Oversampling >>>>> to handle unbalance data\n","\n","df_demand = cleaned_df[cleaned_df['label'] == 'طلب']\n","df_offer = cleaned_df[cleaned_df['label'] == 'عرض']\n","\n","if len(df_demand) == 0:\n","    print(\"Warning: No 'طلب' messages found for upsampling.\")\n","    df_balanced = df_offer.copy()\n","elif len(df_offer) == 0:\n","    print(\"Warning: No 'عرض' messages found for upsampling.\")\n","    df_balanced = df_demand.copy()\n","else:\n","    df_demand_upsampled = resample(df_demand, replace= True, n_samples= len(df_offer), random_state= 42)\n","    df_balanced = pd.concat([df_offer, df_demand_upsampled])\n","    df_balanced = df_balanced.sample(frac=1).reset_index(drop=True)\n"]},{"cell_type":"code","execution_count":368,"metadata":{"id":"e8sMdLf-e68o","executionInfo":{"status":"ok","timestamp":1754331145202,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["texts = df_balanced['cleaned_message_for_model']\n","labels = df_balanced['label']"]},{"cell_type":"code","execution_count":369,"metadata":{"collapsed":true,"executionInfo":{"elapsed":92,"status":"ok","timestamp":1754331145311,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"Rgi5Q4a5ggwk","colab":{"base_uri":"https://localhost:8080/","height":874},"outputId":"7585d7f8-d6d7-4e24-8cf6-b3f2f5749fbf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                       id  \\\n","0    9f5bb222-c391-42c1-aab9-aafa4f460258   \n","1    9f5c8862-3eb8-4f18-a890-e508d768c567   \n","2    9f5bcc66-03e2-4ac2-bc10-d4b8cb1c8eca   \n","3    9f5bb222-c391-42c1-aab9-aafa4f460258   \n","4    9f5f0b60-de54-47e6-92b2-bdde6b52ec47   \n","..                                    ...   \n","491  9f5fc725-cc57-4d9f-96b7-6b51f7ea0801   \n","492  9f5ba2a3-b9d1-48be-8832-1dc10061f4e7   \n","493  9f5bf0e1-32d3-4252-8fba-97bf1e9a4b62   \n","494  9f5dd2f5-0f80-454b-bf2c-0231387b1bf0   \n","495  9f5e4498-0cbe-4e40-8d7c-9234ca2f4f80   \n","\n","                                               message label  \\\n","0    مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   طلب   \n","1    فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...   عرض   \n","2    للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...   عرض   \n","3    مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   طلب   \n","4    للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...   عرض   \n","..                                                 ...   ...   \n","491  مطلوب فيلا في حي الحمراء  مساحه 400 زبون صامل ...   طلب   \n","492  🔶   طلب مباشر  🔶 مطلوب ٣ قطع في العقارية بارك ...   طلب   \n","493  للبيع أدوار بحي النرجس مساحه الدور الارضي 250 ...   عرض   \n","494  للبيع 6 قطع في الملقا راس بلك شارع 20 غربي شار...   عرض   \n","495  للبيع أرض بحى المونسية  اربع شوارع  مرفق تجاري...   عرض   \n","\n","                                                  city state       area  \\\n","0    {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale    1000.00   \n","1    {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale     838.70   \n","2    {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale     420.00   \n","3    {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale    1000.00   \n","4    {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale     630.00   \n","..                                                 ...   ...        ...   \n","491  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale     400.00   \n","492  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale     900.00   \n","493  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale     250.00   \n","494  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale  155348.00   \n","495  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale    2500.00   \n","\n","                             cleaned_message_for_model  \\\n","0    مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   \n","1    فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...   \n","2    للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...   \n","3    مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   \n","4    للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...   \n","..                                                 ...   \n","491  مطلوب فيلا في حي الحمراء  مساحه 400 زبون صامل ...   \n","492     طلب مباشر   مطلوب ٣ قطع في العقارية بارك جم...   \n","493  للبيع أدوار بحي النرجس مساحه الدور الارضي 250 ...   \n","494  للبيع 6 قطع في الملقا راس بلك شارع 20 غربي شار...   \n","495  للبيع أرض بحى المونسية  اربع شوارع  مرفق تجاري...   \n","\n","                                       extracted_links    city_name  \n","0                                              no link   شرق الرياض  \n","1                                              no link   شرق الرياض  \n","2    [https://maps.app.goo.gl/bcuTc2TRU4bVQQ8e7?g_s...  شمال الرياض  \n","3                                              no link   شرق الرياض  \n","4    [https://maps.app.goo.gl/B73CtiSC4g9zwCNy8?g_s...  شمال الرياض  \n","..                                                 ...          ...  \n","491                                            no link   شرق الرياض  \n","492                                            no link   شرق الرياض  \n","493        [https://maps.app.goo.gl/okxSKh3ayB7RVVBm8]  شمال الرياض  \n","494  [https://maps.app.goo.gl/HXVk194yTD69DuBh8?g_s...  شمال الرياض  \n","495                                            no link   شرق الرياض  \n","\n","[496 rows x 9 columns]"],"text/html":["\n","  <div id=\"df-6ab04bc6-2bd6-465c-8541-abeabc532e49\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>label</th>\n","      <th>city</th>\n","      <th>state</th>\n","      <th>area</th>\n","      <th>cleaned_message_for_model</th>\n","      <th>extracted_links</th>\n","      <th>city_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>9f5bb222-c391-42c1-aab9-aafa4f460258</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>1000.00</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>9f5c8862-3eb8-4f18-a890-e508d768c567</td>\n","      <td>فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>838.70</td>\n","      <td>فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>9f5bcc66-03e2-4ac2-bc10-d4b8cb1c8eca</td>\n","      <td>للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>420.00</td>\n","      <td>للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...</td>\n","      <td>[https://maps.app.goo.gl/bcuTc2TRU4bVQQ8e7?g_s...</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>9f5bb222-c391-42c1-aab9-aafa4f460258</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>1000.00</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>9f5f0b60-de54-47e6-92b2-bdde6b52ec47</td>\n","      <td>للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>630.00</td>\n","      <td>للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...</td>\n","      <td>[https://maps.app.goo.gl/B73CtiSC4g9zwCNy8?g_s...</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>491</th>\n","      <td>9f5fc725-cc57-4d9f-96b7-6b51f7ea0801</td>\n","      <td>مطلوب فيلا في حي الحمراء  مساحه 400 زبون صامل ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>400.00</td>\n","      <td>مطلوب فيلا في حي الحمراء  مساحه 400 زبون صامل ...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>492</th>\n","      <td>9f5ba2a3-b9d1-48be-8832-1dc10061f4e7</td>\n","      <td>🔶   طلب مباشر  🔶 مطلوب ٣ قطع في العقارية بارك ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>900.00</td>\n","      <td>طلب مباشر   مطلوب ٣ قطع في العقارية بارك جم...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>493</th>\n","      <td>9f5bf0e1-32d3-4252-8fba-97bf1e9a4b62</td>\n","      <td>للبيع أدوار بحي النرجس مساحه الدور الارضي 250 ...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>250.00</td>\n","      <td>للبيع أدوار بحي النرجس مساحه الدور الارضي 250 ...</td>\n","      <td>[https://maps.app.goo.gl/okxSKh3ayB7RVVBm8]</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>494</th>\n","      <td>9f5dd2f5-0f80-454b-bf2c-0231387b1bf0</td>\n","      <td>للبيع 6 قطع في الملقا راس بلك شارع 20 غربي شار...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>155348.00</td>\n","      <td>للبيع 6 قطع في الملقا راس بلك شارع 20 غربي شار...</td>\n","      <td>[https://maps.app.goo.gl/HXVk194yTD69DuBh8?g_s...</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>495</th>\n","      <td>9f5e4498-0cbe-4e40-8d7c-9234ca2f4f80</td>\n","      <td>للبيع أرض بحى المونسية  اربع شوارع  مرفق تجاري...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>2500.00</td>\n","      <td>للبيع أرض بحى المونسية  اربع شوارع  مرفق تجاري...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>496 rows × 9 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6ab04bc6-2bd6-465c-8541-abeabc532e49')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-6ab04bc6-2bd6-465c-8541-abeabc532e49 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-6ab04bc6-2bd6-465c-8541-abeabc532e49');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-29f97315-e81b-447d-b825-61bde2f56f83\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-29f97315-e81b-447d-b825-61bde2f56f83')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-29f97315-e81b-447d-b825-61bde2f56f83 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_d169480e-db9a-4866-8cba-e59b6308e7f9\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_balanced')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_d169480e-db9a-4866-8cba-e59b6308e7f9 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df_balanced');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_balanced","summary":"{\n  \"name\": \"df_balanced\",\n  \"rows\": 496,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 301,\n        \"samples\": [\n          \"9f5fd557-097f-46db-aec2-190f0f74e24d\",\n          \"9f5bc570-f9e5-4994-bd54-d6e06d463c68\",\n          \"9f59e262-3827-4b09-b546-e3c6988bad1a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"message\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 301,\n        \"samples\": [\n          \"https://maps.app.goo.gl/P2zV6ua2heExh1xG6?g_st=com.google.maps.preview.copy  \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0641\\u064a\\u0644\\u0627<br />\\n\\u0628\\u0642\\u064a\\u0645\\u0647 \\u0627\\u0631\\u0636  \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0633\\u0648\\u064a\\u062f\\u064a \\u0627\\u0644\\u063a\\u0631\\u0628\\u064a  \\u0645\\u0633\\u0627\\u062d\\u0647 \\u0668\\u0667\\u0665 \\u0645  \\u0634\\u0627\\u0631\\u0639 \\u0662\\u0660<br />\\n\\u0634\\u0631\\u0642\\u064a  \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 \\u0662\\u0665 \\u0641 \\u0663\\u0665  \\u0627\\u0644\\u0628\\u064a\\u0639\\u0662\\u0669\\u0660\\u0660 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0645\\u0628\\u0627\\u0634\\u0631\\u0647 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0644\",\n          \"\\u0639\\u0645\\u0627\\u0631\\u0629 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0647 \\u0633\\u0643\\u0646\\u064a\\u0647 \\u062c\\u062f\\u064a\\u062f\\u0647 \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0639\\u0627\\u0631\\u0636 \\u0639 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0642\\u0648\\u0627\\u062a <br />\\n\\u0645\\u0633\\u0627\\u062d\\u062a\\u0647\\u0627 \\u0669\\u0661\\u0666 \\u0645\\u062a\\u0631 \\u064a\\u0648\\u062c\\u062f \\u0641\\u064a\\u0647\\u0627 \\u0664 \\u0645\\u062d\\u0644\\u0627\\u062a \\u0648\\u0666 \\u0634\\u0642\\u0642 \\u0643\\u0644 \\u0634\\u0642\\u0647 \\u0663 \\u0648\\u0635\\u0627\\u0644\\u0647 <br />\\n\\u0645\\u0648\\u0627\\u0642\\u0641 \\u062e\\u0644\\u0641\\u064a\\u0647 \\u062e\\u0627\\u0635\\u0647 \\u0644\\u0633\\u0627\\u0643\\u0646\\u064a\\u0646 \\u0627\\u0644\\u0634\\u0642\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 \\u0661\\u0662 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0627\\u0644\\u062d\\u062f \\u0661\\u0664<br />\\n\\u0645\\u0644\\u064a\\u0648\\u0646  (\\u0645\\u0639 \\u0648\\u0643\\u064a\\u0644 \\u0627\\u0644\\u0627\\u0641\\u0631\\u0627\\u063a) \\u0648\\u0627\\u062a\\u0633:0542467900 \\u0641\\u0627\\u0644:1100036382\",\n          \"https://maps.app.goo.gl/41Z1yvDxDLYY7h9w7?g_st=aw \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0641\\u064a\\u0644\\u0627 \\u0628\\u0642\\u064a\\u0645\\u0647 \\u0627\\u0631\\u0636 \\u0641\\u064a \\u062d\\u064a<br />\\n\\u0627\\u0644\\u064a\\u0631\\u0645\\u0648\\u0643  \\u0646\\u0638\\u0627\\u0645 \\u0627\\u0644\\u0641\\u064a\\u0644\\u0627 \\u062f\\u0631\\u062c \\u0635\\u0627\\u0644\\u0647 \\u0645\\u0639 \\u0634\\u0642\\u062a\\u064a\\u0646  \\u0627\\u0644\\u0634\\u0642\\u0642 \\u0645\\u0648\\u062c\\u0631 \\u0634\\u0642\\u0647<br />\\n\\u0663\\u0660 \\u0648 \\u0634\\u0642\\u0647 \\u0663\\u0665 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 \\u0665\\u0666\\u0660  \\u0627\\u0644\\u0627\\u0637\\u0648\\u0627\\u0644 \\u0662\\u0660&\\u0662\\u0668 \\u0627\\u0644\\u0648\\u0627\\u062c\\u0647\\u0647 \\u0634\\u0645\\u0627\\u0644\\u064a\\u0647 <br />\\n\\u0639\\u0631\\u0636 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 \\u0661\\u0665 \\u0645\\u0643\\u0648\\u0646\\u0627\\u062a \\u0627\\u0644\\u0641\\u064a\\u0644\\u0627  \\u0627\\u0644\\u062f\\u0648\\u0631 \\u0627\\u0644\\u0627\\u0631\\u0636\\u064a \\u064a\\u062a\\u0643\\u0648\\u0646 \\u0645\\u0646 \\u0645\\u062c\\u0644\\u0633<br />\\n\\u0631\\u062c\\u0627\\u0644 \\u0645\\u0639 \\u062f\\u0648\\u0631\\u0647 \\u0645\\u064a\\u0627\\u0647 \\u0648\\u062c\\u0644\\u0633\\u0647 \\u062e\\u0627\\u0631\\u062c\\u064a\\u0647 \\u0648 \\u0645\\u062f\\u062e\\u0644 \\u0633\\u064a\\u0627\\u0631\\u0647 \\u0648 \\u0645\\u0637\\u0628\\u062e<br />\\n\\u062f\\u0627\\u062e\\u0644\\u064a \\u0645\\u0641\\u062a\\u0648\\u062d \\u0648 \\u0645\\u0637\\u0628\\u062e \\u062e\\u0627\\u0631\\u062c\\u064a \\u0648\\u0635\\u0627\\u0644\\u0647 \\u0628\\u064a\\u062a \\u0648\\u0627\\u0633\\u0639\\u0647 \\u063a\\u0631\\u0641\\u0647 \\u0634\\u063a\\u0627\\u0644\\u0647 \\u0648<br />\\n\\u0645\\u0639 \\u062f\\u0648\\u0631\\u0647 \\u0645\\u064a\\u0627\\u0647 \\u0648 \\u063a\\u0631\\u0641\\u0647 \\u063a\\u0633\\u064a\\u0644  \\u0627\\u0644\\u062f\\u0648\\u0631 \\u0627\\u0644\\u062b\\u0627\\u0646\\u064a \\u064a\\u062a\\u0643\\u0648\\u0646 \\u0645\\u0646  \\u0665 \\u063a\\u0631\\u0641<br />\\n\\u0646\\u0648\\u0645 \\u0648\\u0663 \\u062f\\u0648\\u0631\\u0627\\u062a \\u0645\\u064a\\u0627\\u0647 \\u0648 \\u0635\\u0627\\u0644\\u0647  \\u0627\\u0644\\u0634\\u0642\\u0642 \\u062a\\u062a\\u0643\\u0648\\u0646 \\u0645\\u0646  \\u0645\\u062c\\u0644\\u0633 \\u0648 \\u0635\\u0627\\u0644\\u0647<br />\\n\\u0648\\u0645\\u0637\\u0628\\u062e \\u0663 \\u063a\\u0631\\u0641 \\u0646\\u0648\\u0645 \\u0648\\u0663\\u062f\\u0648\\u0631\\u0627\\u062a \\u0645\\u064a\\u0627\\u0647  \\u0627\\u0644\\u0641\\u064a\\u0644\\u0627 \\u0639\\u0644\\u064a\\u0647\\u0627 \\u0645\\u062f\\u064a\\u0648\\u0646\\u064a\\u0647 \\u0664\\u0660\\u0660<br />\\n\\u0627\\u0644\\u0641  \\u0627\\u0644\\u0628\\u064a\\u0639 \\u0663 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0639\\u0644\\u064a \\u0634\\u0648\\u0631  \\u0645\\u0628\\u0627\\u0634\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0644\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"\\u0639\\u0631\\u0636\",\n          \"\\u0637\\u0644\\u0628\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"state\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"none\",\n          \"investment\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"area\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 172,\n        \"samples\": [\n          \"1095.00\",\n          \"15776.00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"cleaned_message_for_model\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 301,\n        \"samples\": [\n          \"https://maps.app.goo.gl/P2zV6ua2heExh1xG6?g_st=com.google.maps.preview.copy  \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0641\\u064a\\u0644\\u0627<br />\\n\\u0628\\u0642\\u064a\\u0645\\u0647 \\u0627\\u0631\\u0636  \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0633\\u0648\\u064a\\u062f\\u064a \\u0627\\u0644\\u063a\\u0631\\u0628\\u064a  \\u0645\\u0633\\u0627\\u062d\\u0647 \\u0668\\u0667\\u0665 \\u0645  \\u0634\\u0627\\u0631\\u0639 \\u0662\\u0660<br />\\n\\u0634\\u0631\\u0642\\u064a  \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 \\u0662\\u0665 \\u0641 \\u0663\\u0665  \\u0627\\u0644\\u0628\\u064a\\u0639\\u0662\\u0669\\u0660\\u0660 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0645\\u0628\\u0627\\u0634\\u0631\\u0647 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0644\",\n          \"\\u0639\\u0645\\u0627\\u0631\\u0629 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0647 \\u0633\\u0643\\u0646\\u064a\\u0647 \\u062c\\u062f\\u064a\\u062f\\u0647 \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0639\\u0627\\u0631\\u0636 \\u0639 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0642\\u0648\\u0627\\u062a <br />\\n\\u0645\\u0633\\u0627\\u062d\\u062a\\u0647\\u0627 \\u0669\\u0661\\u0666 \\u0645\\u062a\\u0631 \\u064a\\u0648\\u062c\\u062f \\u0641\\u064a\\u0647\\u0627 \\u0664 \\u0645\\u062d\\u0644\\u0627\\u062a \\u0648\\u0666 \\u0634\\u0642\\u0642 \\u0643\\u0644 \\u0634\\u0642\\u0647 \\u0663 \\u0648\\u0635\\u0627\\u0644\\u0647 <br />\\n\\u0645\\u0648\\u0627\\u0642\\u0641 \\u062e\\u0644\\u0641\\u064a\\u0647 \\u062e\\u0627\\u0635\\u0647 \\u0644\\u0633\\u0627\\u0643\\u0646\\u064a\\u0646 \\u0627\\u0644\\u0634\\u0642\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 \\u0661\\u0662 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0627\\u0644\\u062d\\u062f \\u0661\\u0664<br />\\n\\u0645\\u0644\\u064a\\u0648\\u0646  (\\u0645\\u0639 \\u0648\\u0643\\u064a\\u0644 \\u0627\\u0644\\u0627\\u0641\\u0631\\u0627\\u063a) \\u0648\\u0627\\u062a\\u0633:0542467900 \\u0641\\u0627\\u0644:1100036382\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"extracted_links\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"\\u0634\\u0645\\u0627\\u0644 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636\",\n          \"\\u062c\\u0646\\u0648\\u0628 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":369}],"source":["df_balanced"]},{"cell_type":"code","execution_count":370,"metadata":{"executionInfo":{"elapsed":32,"status":"ok","timestamp":1754331145311,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"emvwXVbofA8d","colab":{"base_uri":"https://localhost:8080/"},"outputId":"efda9968-14af-476a-a19e-e95781155c5d"},"outputs":[{"output_type":"stream","name":"stdout","text":["0      مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...\n","1      فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...\n","2      للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...\n","3      مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...\n","4      للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...\n","                             ...                        \n","491    مطلوب فيلا في حي الحمراء  مساحه 400 زبون صامل ...\n","492       طلب مباشر   مطلوب ٣ قطع في العقارية بارك جم...\n","493    للبيع أدوار بحي النرجس مساحه الدور الارضي 250 ...\n","494    للبيع 6 قطع في الملقا راس بلك شارع 20 غربي شار...\n","495    للبيع أرض بحى المونسية  اربع شوارع  مرفق تجاري...\n","Name: cleaned_message_for_model, Length: 496, dtype: object\n"]}],"source":["print(texts)"]},{"cell_type":"code","execution_count":371,"metadata":{"executionInfo":{"elapsed":19,"status":"ok","timestamp":1754331145324,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"VoVigBuJAjkX","colab":{"base_uri":"https://localhost:8080/"},"outputId":"c590f521-cf6a-4990-be24-5a251a430bbf"},"outputs":[{"output_type":"stream","name":"stdout","text":["[0 1 1 0 1 0 0 1 0 0 0 0 1 1 0 1 0 1 0 0 0 0 1 1 0 1 0 1 0 1 1 1 0 0 1 0 0\n"," 1 0 0 0 1 0 0 1 1 1 1 1 0 1 1 1 1 0 0 0 1 0 1 1 1 1 1 1 1 0 1 0 1 1 0 0 0\n"," 1 0 0 0 1 1 0 0 1 0 1 1 1 0 1 1 1 1 0 0 1 0 0 0 1 0 1 1 0 0 1 0 1 0 1 0 0\n"," 0 0 1 1 0 0 1 0 1 0 0 0 1 1 1 1 0 1 0 1 0 0 0 0 1 1 1 0 0 0 0 0 0 1 1 0 0\n"," 0 0 0 1 1 1 1 1 1 0 1 1 0 1 0 0 0 1 1 1 1 0 1 0 0 0 0 0 0 0 0 1 0 1 0 1 1\n"," 0 0 0 0 0 1 0 1 0 0 0 0 1 1 1 1 1 0 0 0 1 1 0 0 0 1 1 1 1 0 1 0 0 0 0 0 0\n"," 0 1 1 0 1 0 1 0 1 0 0 1 1 0 1 1 1 0 1 1 1 0 1 0 1 0 0 0 1 0 0 1 0 1 0 0 1\n"," 0 0 0 0 0 0 1 1 0 1 1 1 1 0 1 1 1 0 1 0 1 0 1 0 0 1 1 0 1 1 1 1 0 1 0 0 1\n"," 0 0 0 0 0 0 1 1 0 0 0 1 0 1 0 0 1 1 1 0 1 1 0 0 0 1 1 1 0 1 0 1 1 1 1 0 1\n"," 1 0 0 1 1 1 1 1 0 1 1 1 0 0 1 1 0 1 1 0 1 1 1 0 1 1 0 1 1 0 0 0 1 0 0 0 0\n"," 1 0 0 1 1 1 0 1 0 0 0 1 0 1 0 0 0 1 0 0 0 0 1 0 1 1 0 1 1 1 1 1 1 1 0 1 1\n"," 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 0 1 1 0 1 0 1 1 1 0 1 1 0 1 0 1 0 0 1 0 0 0\n"," 1 0 1 1 0 0 1 0 0 0 0 1 0 1 0 1 1 1 0 0 0 1 1 1 1 0 1 1 0 1 1 0 0 0 1 0 0\n"," 0 1 1 0 1 1 0 1 1 1 0 0 1 1 1]\n","['طلب' 'عرض']\n"]}],"source":["le = LabelEncoder()\n","y = le.fit_transform(df_balanced['label'])\n","print(y)\n","print(le.classes_)"]},{"cell_type":"code","execution_count":372,"metadata":{"executionInfo":{"elapsed":53,"status":"ok","timestamp":1754331145363,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"KQUUXVStFW1y","colab":{"base_uri":"https://localhost:8080/","height":727},"outputId":"26ed801b-d578-48e0-e61b-8e5daee081ef"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                     id  \\\n","0  9f5bb222-c391-42c1-aab9-aafa4f460258   \n","1  9f5c8862-3eb8-4f18-a890-e508d768c567   \n","2  9f5bcc66-03e2-4ac2-bc10-d4b8cb1c8eca   \n","3  9f5bb222-c391-42c1-aab9-aafa4f460258   \n","4  9f5f0b60-de54-47e6-92b2-bdde6b52ec47   \n","5  9f5fc9f1-06d4-44e6-a1e3-68c6d66b5962   \n","6  9f67558a-13b3-433d-af90-4e9c208d8323   \n","7  9f5bfc10-1d70-412e-a99d-3531ba392b14   \n","8  9f596468-513d-4c62-a3b5-797504defc09   \n","9  9f585cac-e018-421a-ac0c-efecda9328e8   \n","\n","                                             message label  \\\n","0  مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   طلب   \n","1  فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...   عرض   \n","2  للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...   عرض   \n","3  مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   طلب   \n","4  للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...   عرض   \n","5  مطلوب ارض مستودعات مساحة من 15 الف الى 20 الف ...   طلب   \n","6  مطلوب ارض سكنية في النرجس  مساحة 250متر مربع  ...   طلب   \n","7  ارض للبيع حى الرمال مخطط الذهبى  مساحة ٥٦٠ الا...   عرض   \n","8  مطلوب أرض خام ف بنبان بشرط تكون مثمنه  مالكها ...   طلب   \n","9  ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...   طلب   \n","\n","                                                city state        area  \\\n","0  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale     1000.00   \n","1  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale      838.70   \n","2  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale      420.00   \n","3  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale     1000.00   \n","4  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale      630.00   \n","5  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale    20000.00   \n","6  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  none      250.00   \n","7  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale      560.00   \n","8  {'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...  sale  1000000.00   \n","9  {'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...  sale  1000000.00   \n","\n","                           cleaned_message_for_model  \\\n","0  مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   \n","1  فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...   \n","2  للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...   \n","3  مطلوب ارض تجاريه بسعر منافس في<br />\\nالقادسيه...   \n","4  للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...   \n","5  مطلوب ارض مستودعات مساحة من 15 الف الى 20 الف ...   \n","6  مطلوب ارض سكنية في النرجس  مساحة 250متر مربع  ...   \n","7  ارض للبيع حى الرمال مخطط الذهبى  مساحة ٥٦٠ الا...   \n","8  مطلوب أرض خام ف بنبان بشرط تكون مثمنه  مالكها ...   \n","9  ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...   \n","\n","                                     extracted_links    city_name  \n","0                                            no link   شرق الرياض  \n","1                                            no link   شرق الرياض  \n","2  [https://maps.app.goo.gl/bcuTc2TRU4bVQQ8e7?g_s...  شمال الرياض  \n","3                                            no link   شرق الرياض  \n","4  [https://maps.app.goo.gl/B73CtiSC4g9zwCNy8?g_s...  شمال الرياض  \n","5                                            no link   شرق الرياض  \n","6                                            no link  شمال الرياض  \n","7                                            no link   شرق الرياض  \n","8                                            no link  شمال الرياض  \n","9  [https://maps.app.goo.gl/ScsRTNj3CLTyWMfX7?g_s...   شرق الرياض  "],"text/html":["\n","  <div id=\"df-947bcc1f-6b6d-42a1-8335-93a2d33eae0c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>message</th>\n","      <th>label</th>\n","      <th>city</th>\n","      <th>state</th>\n","      <th>area</th>\n","      <th>cleaned_message_for_model</th>\n","      <th>extracted_links</th>\n","      <th>city_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>9f5bb222-c391-42c1-aab9-aafa4f460258</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>1000.00</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>9f5c8862-3eb8-4f18-a890-e508d768c567</td>\n","      <td>فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>838.70</td>\n","      <td>فرصه  للبيع قطع اراضي سكنيه في حي البيان مخطط ...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>9f5bcc66-03e2-4ac2-bc10-d4b8cb1c8eca</td>\n","      <td>للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>420.00</td>\n","      <td>للبيع ارض سكنيه  حي العارض  مخطط دانة الياسمين...</td>\n","      <td>[https://maps.app.goo.gl/bcuTc2TRU4bVQQ8e7?g_s...</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>9f5bb222-c391-42c1-aab9-aafa4f460258</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>1000.00</td>\n","      <td>مطلوب ارض تجاريه بسعر منافس في&lt;br /&gt;\\nالقادسيه...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>9f5f0b60-de54-47e6-92b2-bdde6b52ec47</td>\n","      <td>للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>630.00</td>\n","      <td>للبيع فلتين بقيمه ارض حي النخيل  مساحة كامله ١...</td>\n","      <td>[https://maps.app.goo.gl/B73CtiSC4g9zwCNy8?g_s...</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>9f5fc9f1-06d4-44e6-a1e3-68c6d66b5962</td>\n","      <td>مطلوب ارض مستودعات مساحة من 15 الف الى 20 الف ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>20000.00</td>\n","      <td>مطلوب ارض مستودعات مساحة من 15 الف الى 20 الف ...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>9f67558a-13b3-433d-af90-4e9c208d8323</td>\n","      <td>مطلوب ارض سكنية في النرجس  مساحة 250متر مربع  ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>none</td>\n","      <td>250.00</td>\n","      <td>مطلوب ارض سكنية في النرجس  مساحة 250متر مربع  ...</td>\n","      <td>no link</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>9f5bfc10-1d70-412e-a99d-3531ba392b14</td>\n","      <td>ارض للبيع حى الرمال مخطط الذهبى  مساحة ٥٦٠ الا...</td>\n","      <td>عرض</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>560.00</td>\n","      <td>ارض للبيع حى الرمال مخطط الذهبى  مساحة ٥٦٠ الا...</td>\n","      <td>no link</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>9f596468-513d-4c62-a3b5-797504defc09</td>\n","      <td>مطلوب أرض خام ف بنبان بشرط تكون مثمنه  مالكها ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9da8c3ee-0b31-4747-a1f3-b20308bceca3',...</td>\n","      <td>sale</td>\n","      <td>1000000.00</td>\n","      <td>مطلوب أرض خام ف بنبان بشرط تكون مثمنه  مالكها ...</td>\n","      <td>no link</td>\n","      <td>شمال الرياض</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>9f585cac-e018-421a-ac0c-efecda9328e8</td>\n","      <td>ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...</td>\n","      <td>طلب</td>\n","      <td>{'id': '9daaec6c-57d5-40ff-9a98-dbe10bd25409',...</td>\n","      <td>sale</td>\n","      <td>1000000.00</td>\n","      <td>ارض بحي الرمال  على طريق الثمامة الفرعي  تفتح ...</td>\n","      <td>[https://maps.app.goo.gl/ScsRTNj3CLTyWMfX7?g_s...</td>\n","      <td>شرق الرياض</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-947bcc1f-6b6d-42a1-8335-93a2d33eae0c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-947bcc1f-6b6d-42a1-8335-93a2d33eae0c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-947bcc1f-6b6d-42a1-8335-93a2d33eae0c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-5fc7b2f8-2e33-4b5f-999c-b08485b2c0d9\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-5fc7b2f8-2e33-4b5f-999c-b08485b2c0d9')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-5fc7b2f8-2e33-4b5f-999c-b08485b2c0d9 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_balanced","summary":"{\n  \"name\": \"df_balanced\",\n  \"rows\": 496,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 301,\n        \"samples\": [\n          \"9f5fd557-097f-46db-aec2-190f0f74e24d\",\n          \"9f5bc570-f9e5-4994-bd54-d6e06d463c68\",\n          \"9f59e262-3827-4b09-b546-e3c6988bad1a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"message\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 301,\n        \"samples\": [\n          \"https://maps.app.goo.gl/P2zV6ua2heExh1xG6?g_st=com.google.maps.preview.copy  \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0641\\u064a\\u0644\\u0627<br />\\n\\u0628\\u0642\\u064a\\u0645\\u0647 \\u0627\\u0631\\u0636  \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0633\\u0648\\u064a\\u062f\\u064a \\u0627\\u0644\\u063a\\u0631\\u0628\\u064a  \\u0645\\u0633\\u0627\\u062d\\u0647 \\u0668\\u0667\\u0665 \\u0645  \\u0634\\u0627\\u0631\\u0639 \\u0662\\u0660<br />\\n\\u0634\\u0631\\u0642\\u064a  \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 \\u0662\\u0665 \\u0641 \\u0663\\u0665  \\u0627\\u0644\\u0628\\u064a\\u0639\\u0662\\u0669\\u0660\\u0660 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0645\\u0628\\u0627\\u0634\\u0631\\u0647 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0644\",\n          \"\\u0639\\u0645\\u0627\\u0631\\u0629 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0647 \\u0633\\u0643\\u0646\\u064a\\u0647 \\u062c\\u062f\\u064a\\u062f\\u0647 \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0639\\u0627\\u0631\\u0636 \\u0639 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0642\\u0648\\u0627\\u062a <br />\\n\\u0645\\u0633\\u0627\\u062d\\u062a\\u0647\\u0627 \\u0669\\u0661\\u0666 \\u0645\\u062a\\u0631 \\u064a\\u0648\\u062c\\u062f \\u0641\\u064a\\u0647\\u0627 \\u0664 \\u0645\\u062d\\u0644\\u0627\\u062a \\u0648\\u0666 \\u0634\\u0642\\u0642 \\u0643\\u0644 \\u0634\\u0642\\u0647 \\u0663 \\u0648\\u0635\\u0627\\u0644\\u0647 <br />\\n\\u0645\\u0648\\u0627\\u0642\\u0641 \\u062e\\u0644\\u0641\\u064a\\u0647 \\u062e\\u0627\\u0635\\u0647 \\u0644\\u0633\\u0627\\u0643\\u0646\\u064a\\u0646 \\u0627\\u0644\\u0634\\u0642\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 \\u0661\\u0662 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0627\\u0644\\u062d\\u062f \\u0661\\u0664<br />\\n\\u0645\\u0644\\u064a\\u0648\\u0646  (\\u0645\\u0639 \\u0648\\u0643\\u064a\\u0644 \\u0627\\u0644\\u0627\\u0641\\u0631\\u0627\\u063a) \\u0648\\u0627\\u062a\\u0633:0542467900 \\u0641\\u0627\\u0644:1100036382\",\n          \"https://maps.app.goo.gl/41Z1yvDxDLYY7h9w7?g_st=aw \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0641\\u064a\\u0644\\u0627 \\u0628\\u0642\\u064a\\u0645\\u0647 \\u0627\\u0631\\u0636 \\u0641\\u064a \\u062d\\u064a<br />\\n\\u0627\\u0644\\u064a\\u0631\\u0645\\u0648\\u0643  \\u0646\\u0638\\u0627\\u0645 \\u0627\\u0644\\u0641\\u064a\\u0644\\u0627 \\u062f\\u0631\\u062c \\u0635\\u0627\\u0644\\u0647 \\u0645\\u0639 \\u0634\\u0642\\u062a\\u064a\\u0646  \\u0627\\u0644\\u0634\\u0642\\u0642 \\u0645\\u0648\\u062c\\u0631 \\u0634\\u0642\\u0647<br />\\n\\u0663\\u0660 \\u0648 \\u0634\\u0642\\u0647 \\u0663\\u0665 \\u0627\\u0644\\u0645\\u0633\\u0627\\u062d\\u0647 \\u0665\\u0666\\u0660  \\u0627\\u0644\\u0627\\u0637\\u0648\\u0627\\u0644 \\u0662\\u0660&\\u0662\\u0668 \\u0627\\u0644\\u0648\\u0627\\u062c\\u0647\\u0647 \\u0634\\u0645\\u0627\\u0644\\u064a\\u0647 <br />\\n\\u0639\\u0631\\u0636 \\u0627\\u0644\\u0634\\u0627\\u0631\\u0639 \\u0661\\u0665 \\u0645\\u0643\\u0648\\u0646\\u0627\\u062a \\u0627\\u0644\\u0641\\u064a\\u0644\\u0627  \\u0627\\u0644\\u062f\\u0648\\u0631 \\u0627\\u0644\\u0627\\u0631\\u0636\\u064a \\u064a\\u062a\\u0643\\u0648\\u0646 \\u0645\\u0646 \\u0645\\u062c\\u0644\\u0633<br />\\n\\u0631\\u062c\\u0627\\u0644 \\u0645\\u0639 \\u062f\\u0648\\u0631\\u0647 \\u0645\\u064a\\u0627\\u0647 \\u0648\\u062c\\u0644\\u0633\\u0647 \\u062e\\u0627\\u0631\\u062c\\u064a\\u0647 \\u0648 \\u0645\\u062f\\u062e\\u0644 \\u0633\\u064a\\u0627\\u0631\\u0647 \\u0648 \\u0645\\u0637\\u0628\\u062e<br />\\n\\u062f\\u0627\\u062e\\u0644\\u064a \\u0645\\u0641\\u062a\\u0648\\u062d \\u0648 \\u0645\\u0637\\u0628\\u062e \\u062e\\u0627\\u0631\\u062c\\u064a \\u0648\\u0635\\u0627\\u0644\\u0647 \\u0628\\u064a\\u062a \\u0648\\u0627\\u0633\\u0639\\u0647 \\u063a\\u0631\\u0641\\u0647 \\u0634\\u063a\\u0627\\u0644\\u0647 \\u0648<br />\\n\\u0645\\u0639 \\u062f\\u0648\\u0631\\u0647 \\u0645\\u064a\\u0627\\u0647 \\u0648 \\u063a\\u0631\\u0641\\u0647 \\u063a\\u0633\\u064a\\u0644  \\u0627\\u0644\\u062f\\u0648\\u0631 \\u0627\\u0644\\u062b\\u0627\\u0646\\u064a \\u064a\\u062a\\u0643\\u0648\\u0646 \\u0645\\u0646  \\u0665 \\u063a\\u0631\\u0641<br />\\n\\u0646\\u0648\\u0645 \\u0648\\u0663 \\u062f\\u0648\\u0631\\u0627\\u062a \\u0645\\u064a\\u0627\\u0647 \\u0648 \\u0635\\u0627\\u0644\\u0647  \\u0627\\u0644\\u0634\\u0642\\u0642 \\u062a\\u062a\\u0643\\u0648\\u0646 \\u0645\\u0646  \\u0645\\u062c\\u0644\\u0633 \\u0648 \\u0635\\u0627\\u0644\\u0647<br />\\n\\u0648\\u0645\\u0637\\u0628\\u062e \\u0663 \\u063a\\u0631\\u0641 \\u0646\\u0648\\u0645 \\u0648\\u0663\\u062f\\u0648\\u0631\\u0627\\u062a \\u0645\\u064a\\u0627\\u0647  \\u0627\\u0644\\u0641\\u064a\\u0644\\u0627 \\u0639\\u0644\\u064a\\u0647\\u0627 \\u0645\\u062f\\u064a\\u0648\\u0646\\u064a\\u0647 \\u0664\\u0660\\u0660<br />\\n\\u0627\\u0644\\u0641  \\u0627\\u0644\\u0628\\u064a\\u0639 \\u0663 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0639\\u0644\\u064a \\u0634\\u0648\\u0631  \\u0645\\u0628\\u0627\\u0634\\u0631 \\u0645\\u0646 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0644\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"\\u0639\\u0631\\u0636\",\n          \"\\u0637\\u0644\\u0628\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"state\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"none\",\n          \"investment\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"area\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 172,\n        \"samples\": [\n          \"1095.00\",\n          \"15776.00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"cleaned_message_for_model\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 301,\n        \"samples\": [\n          \"https://maps.app.goo.gl/P2zV6ua2heExh1xG6?g_st=com.google.maps.preview.copy  \\u0644\\u0644\\u0628\\u064a\\u0639 \\u0641\\u064a\\u0644\\u0627<br />\\n\\u0628\\u0642\\u064a\\u0645\\u0647 \\u0627\\u0631\\u0636  \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0633\\u0648\\u064a\\u062f\\u064a \\u0627\\u0644\\u063a\\u0631\\u0628\\u064a  \\u0645\\u0633\\u0627\\u062d\\u0647 \\u0668\\u0667\\u0665 \\u0645  \\u0634\\u0627\\u0631\\u0639 \\u0662\\u0660<br />\\n\\u0634\\u0631\\u0642\\u064a  \\u0627\\u0644\\u0623\\u0637\\u0648\\u0627\\u0644 \\u0662\\u0665 \\u0641 \\u0663\\u0665  \\u0627\\u0644\\u0628\\u064a\\u0639\\u0662\\u0669\\u0660\\u0660 \\u0644\\u0644\\u0645\\u062a\\u0631 \\u0645\\u0628\\u0627\\u0634\\u0631\\u0647 \\u0627\\u0644\\u0648\\u0643\\u064a\\u0644\",\n          \"\\u0639\\u0645\\u0627\\u0631\\u0629 \\u062a\\u062c\\u0627\\u0631\\u064a\\u0647 \\u0633\\u0643\\u0646\\u064a\\u0647 \\u062c\\u062f\\u064a\\u062f\\u0647 \\u0641\\u064a \\u062d\\u064a \\u0627\\u0644\\u0639\\u0627\\u0631\\u0636 \\u0639 \\u0634\\u0627\\u0631\\u0639 \\u0627\\u0644\\u0642\\u0648\\u0627\\u062a <br />\\n\\u0645\\u0633\\u0627\\u062d\\u062a\\u0647\\u0627 \\u0669\\u0661\\u0666 \\u0645\\u062a\\u0631 \\u064a\\u0648\\u062c\\u062f \\u0641\\u064a\\u0647\\u0627 \\u0664 \\u0645\\u062d\\u0644\\u0627\\u062a \\u0648\\u0666 \\u0634\\u0642\\u0642 \\u0643\\u0644 \\u0634\\u0642\\u0647 \\u0663 \\u0648\\u0635\\u0627\\u0644\\u0647 <br />\\n\\u0645\\u0648\\u0627\\u0642\\u0641 \\u062e\\u0644\\u0641\\u064a\\u0647 \\u062e\\u0627\\u0635\\u0647 \\u0644\\u0633\\u0627\\u0643\\u0646\\u064a\\u0646 \\u0627\\u0644\\u0634\\u0642\\u0642  \\u0627\\u0644\\u0633\\u0648\\u0645 \\u0661\\u0662 \\u0645\\u0644\\u064a\\u0648\\u0646 \\u0627\\u0644\\u062d\\u062f \\u0661\\u0664<br />\\n\\u0645\\u0644\\u064a\\u0648\\u0646  (\\u0645\\u0639 \\u0648\\u0643\\u064a\\u0644 \\u0627\\u0644\\u0627\\u0641\\u0631\\u0627\\u063a) \\u0648\\u0627\\u062a\\u0633:0542467900 \\u0641\\u0627\\u0644:1100036382\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"extracted_links\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"\\u0634\\u0645\\u0627\\u0644 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636\",\n          \"\\u062c\\u0646\\u0648\\u0628 \\u0627\\u0644\\u0631\\u064a\\u0627\\u0636\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":372}],"source":["df_balanced.head(10)"]},{"cell_type":"markdown","metadata":{"id":"fZEJ-rcIYyc6"},"source":["# ***Modeling***\n","Machine Learning\n","Deep Learning & LSTM"]},{"cell_type":"code","source":["print(len(df_balanced))\n","print(df_balanced['cleaned_message_for_model'].isnull().sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"iivlYqbwcLkO","executionInfo":{"status":"ok","timestamp":1754331145373,"user_tz":-180,"elapsed":9,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"a7e23beb-aab3-46e8-bc1b-a33b04ecd7d5"},"execution_count":373,"outputs":[{"output_type":"stream","name":"stdout","text":["496\n","0\n"]}]},{"cell_type":"code","source":["df_balanced = df_balanced[df_balanced['label'].notnull()]\n","print(len(df_balanced))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2RO5GEz9cWL4","executionInfo":{"status":"ok","timestamp":1754331145409,"user_tz":-180,"elapsed":24,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"de758fa9-dc78-4291-8b1d-b628abbc5f47"},"execution_count":374,"outputs":[{"output_type":"stream","name":"stdout","text":["496\n"]}]},{"cell_type":"code","source":["cleaned_df['label'] = cleaned_df['message'].apply(extract_label)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Yi9wQbtLcgNq","executionInfo":{"status":"ok","timestamp":1754331145412,"user_tz":-180,"elapsed":20,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"dd5add06-61d3-4f18-ccfa-d68680f9f66e"},"execution_count":375,"outputs":[{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-2823839415.py:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  cleaned_df['label'] = cleaned_df['message'].apply(extract_label)\n"]}]},{"cell_type":"code","source":["#TF-IDF\n","vectorizer = TfidfVectorizer(max_features=5000, ngram_range=(1, 2))\n","X = vectorizer.fit_transform(texts)"],"metadata":{"id":"L3DUod1IZms6","executionInfo":{"status":"ok","timestamp":1754331145488,"user_tz":-180,"elapsed":80,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":376,"outputs":[]},{"cell_type":"code","source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","model = xgb.XGBClassifier(use_label_encoder=False, eval_metric='mlogloss')\n","model.fit(X_train, y_train)\n","\n","y_pred = model.predict(X_test)\n","print(classification_report(y_test, y_pred, target_names=le.classes_))\n","print(confusion_matrix(y_test, y_pred))\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"L6ixzjAJdrrk","executionInfo":{"status":"ok","timestamp":1754331145784,"user_tz":-180,"elapsed":294,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"4403ea57-761d-4077-c172-f3d34b3772d8"},"execution_count":377,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/xgboost/training.py:183: UserWarning: [18:12:24] WARNING: /workspace/src/learner.cc:738: \n","Parameters: { \"use_label_encoder\" } are not used.\n","\n","  bst.update(dtrain, iteration=i, fobj=obj)\n"]},{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","         طلب       0.98      1.00      0.99        50\n","         عرض       1.00      0.98      0.99        50\n","\n","    accuracy                           0.99       100\n","   macro avg       0.99      0.99      0.99       100\n","weighted avg       0.99      0.99      0.99       100\n","\n","[[50  0]\n"," [ 1 49]]\n"]}]},{"cell_type":"code","source":["model.score(X_train, y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RMxOPkMahZqV","executionInfo":{"status":"ok","timestamp":1754331145787,"user_tz":-180,"elapsed":11,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"81c05954-ccda-40dd-d1bf-83b8ea18df5c"},"execution_count":378,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1.0"]},"metadata":{},"execution_count":378}]},{"cell_type":"code","source":["model.score(X_test, y_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GB0E9BpNf64J","executionInfo":{"status":"ok","timestamp":1754331145794,"user_tz":-180,"elapsed":8,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"0b2fb360-10a4-4882-9592-f123d1e6f982"},"execution_count":379,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.99"]},"metadata":{},"execution_count":379}]},{"cell_type":"code","source":["joblib.dump(vectorizer, \"tfidf_vectorizer.pkl\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zsblhmScxOGf","executionInfo":{"status":"ok","timestamp":1754331145839,"user_tz":-180,"elapsed":44,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"6ae4d057-f353-4ca0-aacd-db0b4f46eb7a"},"execution_count":380,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['tfidf_vectorizer.pkl']"]},"metadata":{},"execution_count":380}]},{"cell_type":"code","source":["joblib.dump(model, \"xgb_model.pkl\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DYUBdgIoxort","executionInfo":{"status":"ok","timestamp":1754331145887,"user_tz":-180,"elapsed":46,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"0df755ce-7a00-451b-dac7-d2e771937436"},"execution_count":381,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['xgb_model.pkl']"]},"metadata":{},"execution_count":381}]},{"cell_type":"code","source":["joblib.dump(le, \"label_encoder.pkl\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wD9Ntini6IOF","executionInfo":{"status":"ok","timestamp":1754331145893,"user_tz":-180,"elapsed":4,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}},"outputId":"670d80fa-6806-4b66-f10e-475fe353ae69"},"execution_count":382,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['label_encoder.pkl']"]},"metadata":{},"execution_count":382}]},{"cell_type":"code","source":["model.save_model(\"model.json\")"],"metadata":{"id":"dtf7EGWEaavk","executionInfo":{"status":"ok","timestamp":1754331145905,"user_tz":-180,"elapsed":11,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":383,"outputs":[]},{"cell_type":"code","execution_count":384,"metadata":{"id":"kvGFhiqxEw-Z","executionInfo":{"status":"ok","timestamp":1754331145909,"user_tz":-180,"elapsed":3,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# #Padding\n","# tokenizer = Tokenizer(num_words=10000, oov_token='<OOV>')\n","# tokenizer.fit_on_texts(df_balanced['cleaned_message_for_model'])\n","# word_index = tokenizer.word_index\n","# sequences = tokenizer.texts_to_sequences(df_balanced['cleaned_message_for_model'])\n","# padded_sequences = pad_sequences(sequences, maxlen= 100, padding = 'post')"]},{"cell_type":"code","execution_count":385,"metadata":{"id":"pGZfCI4f1N4S","executionInfo":{"status":"ok","timestamp":1754331145924,"user_tz":-180,"elapsed":14,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# Split data into training and testing sets\n","# x_train, x_test, y_train, y_test = train_test_split(padded_sequences, y, test_size=0.2, random_state=42)"]},{"cell_type":"code","execution_count":386,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1754331145935,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"B8XLXI04DN0J"},"outputs":[],"source":["# print(cleaned_df.shape)"]},{"cell_type":"code","execution_count":387,"metadata":{"executionInfo":{"elapsed":26,"status":"ok","timestamp":1754331145963,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"baIbqG9B1RIX"},"outputs":[],"source":["# num_classes = len(le.classes_)\n","# print(num_classes)"]},{"cell_type":"code","execution_count":388,"metadata":{"executionInfo":{"elapsed":14,"status":"ok","timestamp":1754331145967,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"Nw1S10M61RE9"},"outputs":[],"source":["# #LSTM\n","# model= keras.Sequential()\n","# model.add(Embedding(input_dim=10000, output_dim=128, input_length=100))\n","# model.add(LSTM(128, return_sequences=True))\n","# model.add(Dropout(0.3))\n","# model.add(LSTM(64, return_sequences=True))\n","# model.add(Dropout(0.3))\n","# model.add(LSTM(32))\n","# model.add(Dense(num_classes, activation='sigmoid'))"]},{"cell_type":"code","execution_count":389,"metadata":{"id":"snQ4bpgF1RDD","executionInfo":{"status":"ok","timestamp":1754331145968,"user_tz":-180,"elapsed":6,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# model.compile(loss= \"sparse_categorical_crossentropy\", optimizer= \"adam\", metrics= [\"accuracy\"])"]},{"cell_type":"code","execution_count":390,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1754331145969,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"ajrAISAQ4vum"},"outputs":[],"source":["# model.fit(x_train, y_train, epochs=17, validation_data=(x_test, y_test))"]},{"cell_type":"code","execution_count":391,"metadata":{"executionInfo":{"elapsed":14,"status":"ok","timestamp":1754331145981,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"},"user_tz":-180},"id":"IIFmVHnjBpKa"},"outputs":[],"source":["# test_loss, test_acc = model.evaluate(x_test, y_test)\n","# print(f\"Test accuracy: {test_acc}\")"]},{"cell_type":"code","execution_count":392,"metadata":{"id":"t-DCdwyXUMa_","executionInfo":{"status":"ok","timestamp":1754331146000,"user_tz":-180,"elapsed":8,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# model= keras.Sequential()\n","# model.add(Embedding(input_dim=10000, output_dim=128, input_length=100))\n","# model.add(GRU(128, return_sequences=True))\n","# model.add(Dropout(0.4))\n","# model.add(GRU(64, return_sequences=True))\n","# model.add(Dropout(0.4))\n","# model.add(GRU(32))\n","# model.add(Dense(num_classes, activation='sigmoid'))"]},{"cell_type":"code","execution_count":393,"metadata":{"id":"SyAt3CYFUZcf","executionInfo":{"status":"ok","timestamp":1754331146089,"user_tz":-180,"elapsed":79,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"outputs":[],"source":["# model.compile(loss= \"sparse_categorical_crossentropy\", optimizer= \"adam\", metrics= [\"accuracy\"])\n","# model.fit(padded_sequences, y, epochs=12, validation_data=(x_test, y_test))"]},{"cell_type":"markdown","source":["# **Test new data**"],"metadata":{"id":"iMieTCm5mYpQ"}},{"cell_type":"code","source":["# # Test for different data\n","# url = \"https://demo.aqar-tech.com/api/v1/messages\"\n","\n","# all_messages = []\n","\n","# for page in range(12, 15):\n","#     params = {\"page\": page}\n","#     response = requests.get(url, params=params)\n","\n","#     if response.status_code == 200:\n","#         data = response.json()\n","#         messages = data[\"result\"][\"data\"]\n","#         all_messages.extend(messages)\n","#         print(f\"Loaded page {page} with {len(messages)} messages.\")\n","#     else:\n","#         print(f\"Failed to load page {page}, status: {response.status_code}\")\n","\n","# test_df = pd.DataFrame(all_messages)\n","# print(f\"\\nTotal messages collected: {len(test_df)}\")\n","# print(test_df)"],"metadata":{"id":"MhkGjycamXuM","executionInfo":{"status":"ok","timestamp":1754331146092,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":394,"outputs":[]},{"cell_type":"markdown","source":["preprocessing\n","\n","\n","\n"],"metadata":{"id":"eciHiJwn0QaR"}},{"cell_type":"code","source":["# test_df = test_df[test_df['city'].notnull()]\n","# test_df = test_df[test_df['state'].notnull()]\n","# test_df = test_df[test_df['area'].notnull()]\n","# test_df = test_df[test_df['id'].notnull()]\n","# test_df.head(599)"],"metadata":{"collapsed":true,"id":"g6BDoVnjmSAy","executionInfo":{"status":"ok","timestamp":1754331146096,"user_tz":-180,"elapsed":2,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":395,"outputs":[]},{"cell_type":"code","source":["# test_df.rename(columns={'message_type_ar': 'label'}, inplace=True)\n","# test_df = test_df.dropna(subset=['label'])\n","# test_df= test_df[['id','message', 'label', 'city','state', 'area', ]]                                            # From 266 to 298"],"metadata":{"id":"XNuRRkutmN5g","executionInfo":{"status":"ok","timestamp":1754331146099,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":396,"outputs":[]},{"cell_type":"code","metadata":{"id":"7cc6a34d","executionInfo":{"status":"ok","timestamp":1754331146103,"user_tz":-180,"elapsed":2,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"source":["# test_df['cleaned_message_for_model'] = test_df['message'].apply(full_clean)\n","# display(test_df.head())"],"execution_count":397,"outputs":[]},{"cell_type":"code","source":["# test_df = test_df[test_df['label'] != 'none']"],"metadata":{"id":"p9RPqi-4mEul","executionInfo":{"status":"ok","timestamp":1754331146122,"user_tz":-180,"elapsed":18,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":398,"outputs":[]},{"cell_type":"code","source":["# def full_clean(message):\n","#     if not isinstance(message, str):\n","#         return \"\"\n","\n","#     message = remove_broken_google_maps_links(message)\n","\n","#     text = re.sub(r'(\\d[\\d\\.,]*)\\s*(ريال|جنية|SAR|EGP|درهم|دولار|ألف|مليون|بليون|الاف|ملايين|للف|مليونين|مليونات|مليون ونص|مليون و نص)', '[]', message, flags=re.IGNORECASE)\n","#     text = re.sub(r'\\b\\d{4,10}\\b', '[]', text)\n","\n","#     text = re.sub(r'\\b(05\\d{8}|9665\\d{8}|01\\d{9})\\b', '[]', text)\n","#     text = re.sub(r'\\b\\d{7,8}\\b', '[]', text)\n","\n","#     text = re.sub(r'[\\u064B-\\u0652]', '', text)\n","\n","#     text = re.sub(r'[^\\w\\s]', '', text)\n","\n","#     text = re.sub(r'(.)\\1{2,}', r'\\1', text)\n","\n","#     return text\n","# test_df['cleaned_message_for_model'] = test_df['message'].apply(clean_message_for_model)"],"metadata":{"id":"yLdRnbByjSDg","executionInfo":{"status":"ok","timestamp":1754331146127,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":399,"outputs":[]},{"cell_type":"code","source":["# def extract_google_maps_link(message):\n","#     if not isinstance(message, str):\n","#         return None\n","\n","#     pattern1 = r'(https?://(?:www\\.)?(?:maps\\.google\\.com|goo\\.gl/maps|maps\\.app\\.goo\\.gl)[^\\s]*)'\n","#     match = re.search(pattern1, message)\n","#     if match:\n","#         return match.group(0)\n","\n","#     pattern2 = r'\\bhttps?mapsappgoogl[\\w\\d]+'\n","#     match2 = re.search(pattern2, message)\n","#     if match2:\n","#         return match2.group(0)\n","\n","#     return None\n","# test_df['google_maps_link'] = test_df['message'].apply(extract_google_maps_link)\n","\n","# def remove_google_maps_link(message):\n","#     if not isinstance(message, str):\n","#         return message\n","#     pattern = r'(https?://(?:www\\.)?goo\\.gl/maps/[^\\s]+|https?://maps\\.app\\.goo\\.gl/[^\\s]+|https?://maps\\.google\\.com/[^\\s]+)'\n","#     pattern = r'https?maps?app?goo?gl\\S+|https?://(?:www\\.)?(?:goo\\.gl/maps|maps\\.app\\.goo\\.gl|maps\\.google\\.com)/\\S+'\n","#     return re.sub(pattern, '', message).strip()\n","\n","# test_df['cleaned_message_for_model'] = test_df['cleaned_message_for_model'].apply(remove_google_maps_link)"],"metadata":{"id":"_Ga2DEI6khJm","executionInfo":{"status":"ok","timestamp":1754331146129,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":400,"outputs":[]},{"cell_type":"code","source":["# def clean_message_for_model(message):\n","#     if not isinstance(message, str):\n","#         return \"\"\n","\n","#     emoji_pattern = re.compile(\n","#         r'['\n","#         '\\U00010000-\\U0010FFFF'\n","#         '\\U0001F600-\\U0001F64F'\n","#         '\\U0001F900-\\U0001F9FF'\n","#         ']',\n","#         flags=re.UNICODE\n","#     )\n","#     message = message.replace(\"�\", \"\")\n","#     message = emoji_pattern.sub('', message)\n","#     message = re.sub(r'(?:\\+966|00966|0)5\\d{8}', '[PHONE]', message)\n","#     message = re.sub(r'(\\d{1,3}(?:[.,]?\\d{3})+|\\d+)\\s*(ألف|الف|مليون|دولار|جنيه|ج|ريال|ر\\.س)?', '[PRICE]', message)\n","#     message = re.sub(r'[\\u064B-\\u0652]', '', message)\n","#     message = re.sub(r'[^\\w\\s]', '', message)\n","#     message = re.sub(r'(.)\\1{2,}', r'\\1', message)\n","#     return message\n","\n","\n","# test_df['cleaned_message_for_model'] = test_df['message'].apply(clean_message_for_model)"],"metadata":{"id":"cs8NCtafkpFK","executionInfo":{"status":"ok","timestamp":1754331146147,"user_tz":-180,"elapsed":3,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":401,"outputs":[]},{"cell_type":"code","source":["# import ast\n","\n","# def extract_city_name(city_cell):\n","#     try:\n","#         if isinstance(city_cell, str):\n","#             city_cell = ast.literal_eval(city_cell)\n","\n","#         if isinstance(city_cell, dict):\n","#             translations = city_cell.get('translations', [])\n","#             for item in translations:\n","#                 if item.get('locale') == 'ar':\n","#                     return item.get('name')\n","\n","#             return city_cell.get('name')\n","#     except:\n","#         return None\n","\n","\n","\n","# test_df['city_name'] = test_df['city'].apply(extract_city_name)"],"metadata":{"id":"GJdEXM45kxsg","executionInfo":{"status":"ok","timestamp":1754331146150,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":402,"outputs":[]},{"cell_type":"code","source":["# test_df.head()"],"metadata":{"id":"jSIBLnfFBs6d","executionInfo":{"status":"ok","timestamp":1754331146153,"user_tz":-180,"elapsed":2,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":403,"outputs":[]},{"cell_type":"code","source":["# test_df = test_df['google_maps_link'] = test_df['google_maps_link'].fillna(\"unknown\")"],"metadata":{"id":"fBzakbwXCC0Y","executionInfo":{"status":"ok","timestamp":1754331146155,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":404,"outputs":[]},{"cell_type":"code","source":["# test_df['google_maps_link'] = test_df['google_maps_link'].fillna(\"unknown\")\n","# test_df = test_df[test_df['label'].notnull()]"],"metadata":{"id":"LkNO2C7fl5M7","executionInfo":{"status":"ok","timestamp":1754331146173,"user_tz":-180,"elapsed":17,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":405,"outputs":[]},{"cell_type":"code","source":["# test_df['label'].unique()"],"metadata":{"id":"7Bgnpi78loIp","executionInfo":{"status":"ok","timestamp":1754331146190,"user_tz":-180,"elapsed":3,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":406,"outputs":[]},{"cell_type":"code","source":["# test_df.dropna(subset=['label'])"],"metadata":{"id":"92ay02z-m1Yc","executionInfo":{"status":"ok","timestamp":1754331146192,"user_tz":-180,"elapsed":3,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":407,"outputs":[]},{"cell_type":"markdown","source":["loading vectorizer & xgb"],"metadata":{"id":"WSwqCoOk0aH8"}},{"cell_type":"code","source":["# import joblib\n","# vectorizer = joblib.load(\"/content/tfidf_vectorizer.pkl\")\n","# model = joblib.load(\"/content/xgb_model.pkl\")\n","# label_enceoder = joblib.load(\"/content/label_encoder.pkl\")"],"metadata":{"id":"5tZ-aTZK0jYl","executionInfo":{"status":"ok","timestamp":1754331146196,"user_tz":-180,"elapsed":2,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":408,"outputs":[]},{"cell_type":"code","source":["# x_test = test_df['cleaned_message_for_model']\n","# y_test = test_df['label']"],"metadata":{"id":"_GNRhhN3nILG","executionInfo":{"status":"ok","timestamp":1754331146201,"user_tz":-180,"elapsed":3,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":409,"outputs":[]},{"cell_type":"code","source":["# convert texts using vectorizer\n","# X_test = vectorizer.transform(x_test)"],"metadata":{"id":"GdyvMVKm0-Ur","executionInfo":{"status":"ok","timestamp":1754331146203,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":410,"outputs":[]},{"cell_type":"code","source":["# X_test = test_df['cleaned_message_for_model']\n","# X_test_vec = vectorizer.transform(X_test)"],"metadata":{"id":"1r493u4135Vo","executionInfo":{"status":"ok","timestamp":1754331146217,"user_tz":-180,"elapsed":13,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":411,"outputs":[]},{"cell_type":"code","source":["# vectorizer = joblib.load(\"tfidf_vectorizer.pkl\")\n","# model = joblib.load(\"xgb_model.pkl\")\n","# X_test_vec = vectorizer.transform(X_test)\n","# preds = model.predict(X_test_vec)"],"metadata":{"id":"mJQfk5GR4TZN","executionInfo":{"status":"ok","timestamp":1754331146221,"user_tz":-180,"elapsed":2,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":412,"outputs":[]},{"cell_type":"code","source":["# pred_labels = label_enceoder.inverse_transform(preds)\n","# pred_labels"],"metadata":{"id":"qUS3oNX16-aT","executionInfo":{"status":"ok","timestamp":1754331146223,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":413,"outputs":[]},{"cell_type":"code","source":["# from sklearn.metrics import accuracy_score\n","\n","# accuracy = accuracy_score(y_test, pred_labels)\n","# print(f\"Accuracy: {accuracy * 100:.2f}%\")\n","\n","# print(classification_report(y_test, pred_labels))\n"],"metadata":{"id":"oPrqBjme5hnS","executionInfo":{"status":"ok","timestamp":1754331146225,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":414,"outputs":[]},{"cell_type":"markdown","source":["# ***real_estate_api***\n","\n","*   model.json\n","*   preprocessor.pkl\n","\n","*   main.py\n","*   requirements.txt\n"],"metadata":{"id":"hesdyxF7kX59"}},{"cell_type":"code","source":["requirements = '''\n","fastapi\n","pydantic\n","uvicorn\n","scikit-learn\n","xgboost\n","pandas\n","numpy\n","joblib\n","pickle\n","'''\n","\n","with open(\"requirements.txt\", \"w\")as f:\n","  f.write(requirements)"],"metadata":{"id":"hXB02pzahiOa","executionInfo":{"status":"ok","timestamp":1754331146228,"user_tz":-180,"elapsed":1,"user":{"displayName":"Rewan Gamal Harb","userId":"16932710254096027106"}}},"execution_count":415,"outputs":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyMRuKwn7Yyxc5boXt50GUeG"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}